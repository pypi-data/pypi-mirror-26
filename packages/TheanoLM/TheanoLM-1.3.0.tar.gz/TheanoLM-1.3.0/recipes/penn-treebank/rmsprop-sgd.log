/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0,optimizer_excluding=local_gpua_multinomial_wor
Context None device="Quadro K2000" ID="0000:01:00.0"
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-10-21 12:26:20,468 train: TRAINING OPTIONS
2017-10-21 12:26:20,468 train: validation_frequency: 1
2017-10-21 12:26:20,468 train: batch_size: 32
2017-10-21 12:26:20,469 train: min_epochs: 1
2017-10-21 12:26:20,469 train: max_annealing_count: 0
2017-10-21 12:26:20,469 train: patience: 0
2017-10-21 12:26:20,469 train: max_epochs: 15
2017-10-21 12:26:20,469 train: stopping_criterion: no-improvement
2017-10-21 12:26:20,469 train: sequence_length: 25
2017-10-21 12:26:20,469 train: OPTIMIZATION OPTIONS
2017-10-21 12:26:20,469 train: epsilon: 1e-06
2017-10-21 12:26:20,469 train: noise_sharing: None
2017-10-21 12:26:20,469 train: weights: [ 1.]
2017-10-21 12:26:20,470 train: momentum: 0.9
2017-10-21 12:26:20,470 train: max_gradient_norm: 5.0
2017-10-21 12:26:20,470 train: gradient_decay_rate: 0.9
2017-10-21 12:26:20,470 train: sqr_gradient_decay_rate: 0.999
2017-10-21 12:26:20,470 train: num_noise_samples: 1
2017-10-21 12:26:20,470 train: method: rmsprop-sgd
2017-10-21 12:26:20,470 train: learning_rate: 1.0
Creating trainer.
Computing the number of mini-batches in training data.
2017-10-21 12:26:22,030 __init__: One epoch of training data contains 1778 mini-batch updates.
2017-10-21 12:26:22,031 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-10-21 12:26:22,033 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-10-21 12:26:22,056 _reset: Generating a random order of input lines.
Building neural network.
2017-10-21 12:26:22,089 __init__: Creating layers.
2017-10-21 12:26:22,089 __init__: - NetworkInput name=word_input inputs=[] size=10001 activation=tanh devices=[]
2017-10-21 12:26:22,090 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 activation=tanh devices=[None]
2017-10-21 12:26:22,131 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-10-21 12:26:22,131 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 activation=tanh devices=[None]
2017-10-21 12:26:22,135 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-10-21 12:26:22,586 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-10-21 12:26:22,586 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-10-21 12:26:22,586 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 activation=tanh devices=[None]
2017-10-21 12:26:22,718 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-10-21 12:26:22,718 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-10-21 12:26:22,719 __init__: Total number of model parameters: 3935925
Building optimizer.
2017-10-21 12:26:26,098 add:      * layers/hidden_layer/layer_input/W_mean_sqr_gradient size=102400 type=float32 device=None
2017-10-21 12:26:26,104 add:      * layers/output_layer/input/W_mean_sqr_gradient size=2560256 type=float32 device=None
2017-10-21 12:26:26,104 add:      * layers/output_layer/input/b_mean_sqr_gradient size=10001 type=float32 device=None
2017-10-21 12:26:26,106 add:      * layers/projection_layer/W_mean_sqr_gradient size=1000100 type=float32 device=None
2017-10-21 12:26:26,106 add:      * layers/hidden_layer/layer_input/b_mean_sqr_gradient size=1024 type=float32 device=None
2017-10-21 12:26:26,107 add:      * layers/hidden_layer/step_input/W_mean_sqr_gradient size=262144 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-10-21 12:27:15,747 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2017-10-21 12:27:41,893 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2017-10-21 12:28:08,086 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2017-10-21 12:28:34,313 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2017-10-21 12:29:00,547 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2017-10-21 12:29:26,788 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2017-10-21 12:29:53,018 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2017-10-21 12:30:19,253 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2017-10-21 12:30:45,509 _validate: [1772] First validation sample, perplexity 211.37.
2017-10-21 12:30:56,845 _validate: [1775] Center of validation, perplexity 214.03.
2017-10-21 12:31:08,322 _validate: [1778] Last validation sample, perplexity 211.44.
2017-10-21 12:31:08,345 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:31:08,346 _log_validation: [1778] Validation set cost history: [211.4]
2017-10-21 12:31:08,346 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 4.3 minutes. Best validation perplexity 211.44.
2017-10-21 12:31:11,199 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:31:37,415 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:32:03,641 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:32:29,852 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:32:56,057 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:33:22,267 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:33:48,494 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:34:14,702 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:34:40,910 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1, duration = 13.0 ms
2017-10-21 12:35:04,268 _validate: [1772] First validation sample, perplexity 176.86.
2017-10-21 12:35:15,594 _validate: [1775] Center of validation, perplexity 177.72.
2017-10-21 12:35:26,934 _validate: [1778] Last validation sample, perplexity 181.17.
2017-10-21 12:35:26,951 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:35:26,952 _log_validation: [1778] Validation set cost history: 211.4 [178.9]
2017-10-21 12:35:26,953 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 4.3 minutes. Best validation perplexity 178.87.
2017-10-21 12:35:32,500 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:35:57,873 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:36:23,246 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1, duration = 12.5 ms
2017-10-21 12:36:48,606 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1, duration = 12.5 ms
2017-10-21 12:37:13,972 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:37:39,358 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:38:04,748 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:38:30,132 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:38:55,521 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1, duration = 12.6 ms
2017-10-21 12:39:15,460 _validate: [1772] First validation sample, perplexity 161.84.
2017-10-21 12:39:26,772 _validate: [1775] Center of validation, perplexity 160.35.
2017-10-21 12:39:38,104 _validate: [1778] Last validation sample, perplexity 162.77.
2017-10-21 12:39:38,119 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:39:38,120 _log_validation: [1778] Validation set cost history: 211.4 178.9 [161.8]
2017-10-21 12:39:38,121 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 4.2 minutes. Best validation perplexity 161.85.
2017-10-21 12:39:46,471 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:40:11,874 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:40:37,268 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:41:02,675 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:41:28,077 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:41:53,472 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:42:18,877 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:42:44,270 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:43:09,667 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1, duration = 12.6 ms
2017-10-21 12:43:26,813 _validate: [1772] First validation sample, perplexity 155.55.
2017-10-21 12:43:38,131 _validate: [1775] Center of validation, perplexity 154.56.
2017-10-21 12:43:49,469 _validate: [1778] Last validation sample, perplexity 157.08.
2017-10-21 12:43:49,484 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:43:49,485 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 [155.6]
2017-10-21 12:43:49,485 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 4.2 minutes. Best validation perplexity 155.55.
2017-10-21 12:44:00,626 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:44:26,010 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:44:51,387 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:45:16,764 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:45:42,139 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:46:07,525 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:46:32,904 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:46:58,279 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:47:23,660 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1, duration = 12.6 ms
2017-10-21 12:47:38,002 _validate: [1772] First validation sample, perplexity 153.23.
2017-10-21 12:47:49,316 _validate: [1775] Center of validation, perplexity 152.94.
2017-10-21 12:48:00,647 _validate: [1778] Last validation sample, perplexity 154.76.
2017-10-21 12:48:00,662 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:48:00,663 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 [153.8]
2017-10-21 12:48:00,664 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 4.2 minutes. Best validation perplexity 153.85.
2017-10-21 12:48:14,589 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:48:39,952 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:49:05,317 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:49:30,692 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:49:56,056 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:50:21,426 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:50:46,797 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1, duration = 12.6 ms
2017-10-21 12:51:12,188 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1, duration = 12.5 ms
2017-10-21 12:51:37,556 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1, duration = 12.5 ms
2017-10-21 12:51:49,106 _validate: [1772] First validation sample, perplexity 149.13.
2017-10-21 12:52:00,428 _validate: [1775] Center of validation, perplexity 148.74.
2017-10-21 12:52:11,759 _validate: [1778] Last validation sample, perplexity 148.96.
2017-10-21 12:52:11,774 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:52:11,774 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 [149.0]
2017-10-21 12:52:11,775 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.2 minutes. Best validation perplexity 148.96.
2017-10-21 12:52:28,482 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1, duration = 12.5 ms
2017-10-21 12:52:53,848 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:53:19,224 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:53:44,591 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:54:09,963 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:54:35,331 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:55:00,701 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1, duration = 12.5 ms
2017-10-21 12:55:26,068 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:55:51,434 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1, duration = 12.6 ms
2017-10-21 12:56:00,207 _validate: [1772] First validation sample, perplexity 146.22.
2017-10-21 12:56:11,525 _validate: [1775] Center of validation, perplexity 144.44.
2017-10-21 12:56:22,859 _validate: [1778] Last validation sample, perplexity 145.50.
2017-10-21 12:56:22,875 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 12:56:22,875 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 [146.1]
2017-10-21 12:56:22,876 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.2 minutes. Best validation perplexity 146.06.
2017-10-21 12:56:42,378 _log_update: [154] (8.7 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:57:07,744 _log_update: [354] (19.9 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:57:33,107 _log_update: [554] (31.2 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:57:58,472 _log_update: [754] (42.4 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:58:23,842 _log_update: [954] (53.7 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:58:49,208 _log_update: [1154] (64.9 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:59:14,582 _log_update: [1354] (76.2 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 12:59:39,951 _log_update: [1554] (87.4 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 13:00:05,320 _log_update: [1754] (98.7 %) of epoch 8 -- lr = 1, duration = 12.6 ms
2017-10-21 13:00:11,289 _validate: [1772] First validation sample, perplexity 146.76.
2017-10-21 13:00:22,605 _validate: [1775] Center of validation, perplexity 144.04.
2017-10-21 13:00:33,930 _validate: [1778] Last validation sample, perplexity 143.70.
2017-10-21 13:00:33,945 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:00:33,945 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 [144.4]
2017-10-21 13:00:33,946 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 4.2 minutes. Best validation perplexity 144.36.
2017-10-21 13:00:56,247 _log_update: [176] (9.9 %) of epoch 9 -- lr = 1, duration = 12.5 ms
2017-10-21 13:01:21,621 _log_update: [376] (21.1 %) of epoch 9 -- lr = 1, duration = 12.5 ms
2017-10-21 13:01:46,985 _log_update: [576] (32.4 %) of epoch 9 -- lr = 1, duration = 12.6 ms
2017-10-21 13:02:12,359 _log_update: [776] (43.6 %) of epoch 9 -- lr = 1, duration = 12.6 ms
2017-10-21 13:02:37,720 _log_update: [976] (54.9 %) of epoch 9 -- lr = 1, duration = 12.6 ms
2017-10-21 13:03:03,088 _log_update: [1176] (66.1 %) of epoch 9 -- lr = 1, duration = 12.6 ms
2017-10-21 13:03:28,590 _log_update: [1376] (77.4 %) of epoch 9 -- lr = 1, duration = 12.6 ms
2017-10-21 13:03:54,202 _log_update: [1576] (88.6 %) of epoch 9 -- lr = 1, duration = 12.5 ms
2017-10-21 13:04:22,734 _validate: [1772] First validation sample, perplexity 142.31.
2017-10-21 13:04:34,039 _validate: [1775] Center of validation, perplexity 141.63.
2017-10-21 13:04:34,152 _log_update: [1776] (99.9 %) of epoch 9 -- lr = 1, duration = 9.2 ms
2017-10-21 13:04:45,354 _validate: [1778] Last validation sample, perplexity 145.15.
2017-10-21 13:04:45,369 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:04:45,369 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 [143.2]
2017-10-21 13:04:45,369 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 4.2 minutes. Best validation perplexity 143.22.
2017-10-21 13:05:10,454 _log_update: [198] (11.1 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:05:35,813 _log_update: [398] (22.4 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:06:01,185 _log_update: [598] (33.6 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:06:26,551 _log_update: [798] (44.9 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:06:51,914 _log_update: [998] (56.1 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:07:17,280 _log_update: [1198] (67.4 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:07:42,643 _log_update: [1398] (78.6 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:08:08,007 _log_update: [1598] (89.9 %) of epoch 10 -- lr = 1, duration = 12.6 ms
2017-10-21 13:08:33,756 _validate: [1772] First validation sample, perplexity 141.17.
2017-10-21 13:08:45,068 _validate: [1775] Center of validation, perplexity 141.79.
2017-10-21 13:08:56,385 _validate: [1778] Last validation sample, perplexity 143.72.
2017-10-21 13:08:56,400 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:08:56,400 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 [142.5]
2017-10-21 13:08:56,401 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 4.2 minutes. Best validation perplexity 142.47.
2017-10-21 13:08:58,909 _log_update: [20] (1.1 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:09:24,275 _log_update: [220] (12.4 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:09:49,688 _log_update: [420] (23.6 %) of epoch 11 -- lr = 1, duration = 12.5 ms
2017-10-21 13:10:15,051 _log_update: [620] (34.9 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:10:40,409 _log_update: [820] (46.1 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:11:05,783 _log_update: [1020] (57.4 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:11:31,142 _log_update: [1220] (68.6 %) of epoch 11 -- lr = 1, duration = 12.5 ms
2017-10-21 13:11:56,502 _log_update: [1420] (79.9 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:12:21,870 _log_update: [1620] (91.1 %) of epoch 11 -- lr = 1, duration = 12.6 ms
2017-10-21 13:12:44,823 _validate: [1772] First validation sample, perplexity 141.19.
2017-10-21 13:12:56,119 _validate: [1775] Center of validation, perplexity 142.81.
2017-10-21 13:13:07,433 _validate: [1778] Last validation sample, perplexity 141.44.
2017-10-21 13:13:07,433 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 [142.5] 142.4
2017-10-21 13:13:07,435 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-21 13:13:07,435 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-21 13:13:07,436 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-21 13:13:07,436 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-21 13:13:07,439 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-21 13:13:07,440 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-21 13:13:07,441 _reset_state: [1775] (99.83 %) of epoch 10
2017-10-21 13:13:07,441 _log_validation: [1775] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 [142.5]
2017-10-21 13:13:07,442 set_state: Restored iterator to line 41996 of 42068.
2017-10-21 13:13:07,445 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-21 13:13:07,446 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-21 13:13:07,447 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-21 13:13:07,447 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
2017-10-21 13:13:07,447 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-21 13:13:07,448 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 1.0 to 0.5 and resetting state to 100 % of epoch 10.
2017-10-21 13:13:07,449 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 4.2 minutes. Best validation perplexity 142.47.
2017-10-21 13:13:12,747 _log_update: [42] (2.4 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:13:38,108 _log_update: [242] (13.6 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:14:03,474 _log_update: [442] (24.9 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:14:28,834 _log_update: [642] (36.1 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:14:54,208 _log_update: [842] (47.4 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:15:19,581 _log_update: [1042] (58.6 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:15:44,946 _log_update: [1242] (69.9 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:16:10,330 _log_update: [1442] (81.1 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:16:35,692 _log_update: [1642] (92.4 %) of epoch 11 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:16:55,854 _validate: [1772] First validation sample, perplexity 127.25.
2017-10-21 13:17:07,161 _validate: [1775] Center of validation, perplexity 127.82.
2017-10-21 13:17:18,470 _validate: [1778] Last validation sample, perplexity 127.22.
2017-10-21 13:17:18,485 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:17:18,485 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 [127.8]
2017-10-21 13:17:18,486 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 4.2 minutes. Best validation perplexity 127.77.
2017-10-21 13:17:26,561 _log_update: [64] (3.6 %) of epoch 12 -- lr = 0.5, duration = 12.5 ms
2017-10-21 13:17:51,881 _log_update: [264] (14.8 %) of epoch 12 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:18:17,206 _log_update: [464] (26.1 %) of epoch 12 -- lr = 0.5, duration = 12.5 ms
2017-10-21 13:18:42,529 _log_update: [664] (37.3 %) of epoch 12 -- lr = 0.5, duration = 12.5 ms
2017-10-21 13:19:07,858 _log_update: [864] (48.6 %) of epoch 12 -- lr = 0.5, duration = 12.5 ms
2017-10-21 13:19:33,179 _log_update: [1064] (59.8 %) of epoch 12 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:19:58,499 _log_update: [1264] (71.1 %) of epoch 12 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:20:23,824 _log_update: [1464] (82.3 %) of epoch 12 -- lr = 0.5, duration = 12.5 ms
2017-10-21 13:20:49,145 _log_update: [1664] (93.6 %) of epoch 12 -- lr = 0.5, duration = 12.5 ms
2017-10-21 13:21:06,523 _validate: [1772] First validation sample, perplexity 126.64.
2017-10-21 13:21:17,832 _validate: [1775] Center of validation, perplexity 126.74.
2017-10-21 13:21:29,154 _validate: [1778] Last validation sample, perplexity 126.84.
2017-10-21 13:21:29,169 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:21:29,169 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 [126.7]
2017-10-21 13:21:29,170 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 4.2 minutes. Best validation perplexity 126.73.
2017-10-21 13:21:40,051 _log_update: [86] (4.8 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:22:05,425 _log_update: [286] (16.1 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:22:30,790 _log_update: [486] (27.3 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:22:56,152 _log_update: [686] (38.6 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:23:21,523 _log_update: [886] (49.8 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:23:46,887 _log_update: [1086] (61.1 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:24:12,256 _log_update: [1286] (72.3 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:24:37,632 _log_update: [1486] (83.6 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:25:03,000 _log_update: [1686] (94.8 %) of epoch 13 -- lr = 0.5, duration = 12.6 ms
2017-10-21 13:25:17,592 _validate: [1772] First validation sample, perplexity 127.61.
2017-10-21 13:25:28,889 _validate: [1775] Center of validation, perplexity 128.30.
2017-10-21 13:25:40,199 _validate: [1778] Last validation sample, perplexity 127.22.
2017-10-21 13:25:40,199 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 [126.7] 127.6
2017-10-21 13:25:40,200 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-21 13:25:40,201 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-21 13:25:40,201 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-21 13:25:40,202 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-21 13:25:40,205 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-21 13:25:40,205 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-21 13:25:40,207 _reset_state: [1775] (99.83 %) of epoch 12
2017-10-21 13:25:40,207 _log_validation: [1775] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 [126.7]
2017-10-21 13:25:40,207 set_state: Restored iterator to line 42004 of 42068.
2017-10-21 13:25:40,210 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-21 13:25:40,212 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-21 13:25:40,212 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-21 13:25:40,213 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
2017-10-21 13:25:40,213 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-21 13:25:40,214 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.5 to 0.25 and resetting state to 100 % of epoch 12.
2017-10-21 13:25:40,214 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 4.2 minutes. Best validation perplexity 126.73.
2017-10-21 13:25:53,870 _log_update: [108] (6.1 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:26:19,218 _log_update: [308] (17.3 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:26:44,560 _log_update: [508] (28.6 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:27:09,901 _log_update: [708] (39.8 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:27:35,242 _log_update: [908] (51.1 %) of epoch 13 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:28:00,588 _log_update: [1108] (62.3 %) of epoch 13 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:28:25,932 _log_update: [1308] (73.6 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:28:51,273 _log_update: [1508] (84.8 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:29:16,615 _log_update: [1708] (96.1 %) of epoch 13 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:29:28,407 _validate: [1772] First validation sample, perplexity 122.27.
2017-10-21 13:29:39,705 _validate: [1775] Center of validation, perplexity 122.20.
2017-10-21 13:29:51,017 _validate: [1778] Last validation sample, perplexity 121.94.
2017-10-21 13:29:51,032 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:29:51,032 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 [122.2]
2017-10-21 13:29:51,033 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 4.2 minutes. Best validation perplexity 122.20.
2017-10-21 13:30:07,468 _log_update: [130] (7.3 %) of epoch 14 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:30:32,793 _log_update: [330] (18.6 %) of epoch 14 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:30:58,133 _log_update: [530] (29.8 %) of epoch 14 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:31:23,465 _log_update: [730] (41.1 %) of epoch 14 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:31:48,790 _log_update: [930] (52.3 %) of epoch 14 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:32:14,124 _log_update: [1130] (63.6 %) of epoch 14 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:32:39,449 _log_update: [1330] (74.8 %) of epoch 14 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:33:04,782 _log_update: [1530] (86.1 %) of epoch 14 -- lr = 0.2, duration = 12.5 ms
2017-10-21 13:33:30,113 _log_update: [1730] (97.3 %) of epoch 14 -- lr = 0.2, duration = 12.6 ms
2017-10-21 13:33:39,108 _validate: [1772] First validation sample, perplexity 124.50.
2017-10-21 13:33:50,405 _validate: [1775] Center of validation, perplexity 124.21.
2017-10-21 13:34:01,720 _validate: [1778] Last validation sample, perplexity 124.31.
2017-10-21 13:34:01,720 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 [122.2] 124.3
2017-10-21 13:34:01,721 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-21 13:34:01,722 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-21 13:34:01,722 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-21 13:34:01,723 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-21 13:34:01,726 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-21 13:34:01,726 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-21 13:34:01,728 _reset_state: [1775] (99.83 %) of epoch 13
2017-10-21 13:34:01,728 _log_validation: [1775] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 [122.2]
2017-10-21 13:34:01,728 set_state: Restored iterator to line 41999 of 42068.
2017-10-21 13:34:01,731 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-21 13:34:01,733 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-21 13:34:01,733 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-21 13:34:01,734 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
2017-10-21 13:34:01,734 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-21 13:34:01,735 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.25 to 0.125 and resetting state to 100 % of epoch 13.
2017-10-21 13:34:01,735 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 4.2 minutes. Best validation perplexity 122.20.
2017-10-21 13:34:20,977 _log_update: [152] (8.5 %) of epoch 14 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:34:46,346 _log_update: [352] (19.8 %) of epoch 14 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:35:11,706 _log_update: [552] (31.0 %) of epoch 14 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:35:37,060 _log_update: [752] (42.3 %) of epoch 14 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:36:02,423 _log_update: [952] (53.5 %) of epoch 14 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:36:27,778 _log_update: [1152] (64.8 %) of epoch 14 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:36:53,132 _log_update: [1352] (76.0 %) of epoch 14 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:37:18,489 _log_update: [1552] (87.3 %) of epoch 14 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:37:43,843 _log_update: [1752] (98.5 %) of epoch 14 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:37:50,055 _validate: [1772] First validation sample, perplexity 122.15.
2017-10-21 13:38:01,358 _validate: [1775] Center of validation, perplexity 121.34.
2017-10-21 13:38:12,671 _validate: [1778] Last validation sample, perplexity 121.49.
2017-10-21 13:38:12,686 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-21 13:38:12,686 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 122.2 [121.6]
2017-10-21 13:38:12,687 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 4.2 minutes. Best validation perplexity 121.62.
2017-10-21 13:38:34,684 _log_update: [174] (9.8 %) of epoch 15 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:39:00,000 _log_update: [374] (21.0 %) of epoch 15 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:39:25,321 _log_update: [574] (32.3 %) of epoch 15 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:39:50,636 _log_update: [774] (43.5 %) of epoch 15 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:40:15,953 _log_update: [974] (54.8 %) of epoch 15 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:40:41,268 _log_update: [1174] (66.0 %) of epoch 15 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:41:06,613 _log_update: [1374] (77.3 %) of epoch 15 -- lr = 0.1, duration = 12.6 ms
2017-10-21 13:41:31,936 _log_update: [1574] (88.5 %) of epoch 15 -- lr = 0.1, duration = 12.5 ms
2017-10-21 13:42:00,681 _validate: [1772] First validation sample, perplexity 122.70.
2017-10-21 13:42:04,539 _log_update: [1774] (99.8 %) of epoch 15 -- lr = 0.1, duration = 9.0 ms
2017-10-21 13:42:11,984 _validate: [1775] Center of validation, perplexity 123.03.
2017-10-21 13:42:23,297 _validate: [1778] Last validation sample, perplexity 122.99.
2017-10-21 13:42:23,297 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 122.2 [121.6] 123.0
2017-10-21 13:42:23,298 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-21 13:42:23,299 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-21 13:42:23,299 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-21 13:42:23,300 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-21 13:42:23,303 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-21 13:42:23,304 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-21 13:42:23,305 _reset_state: [1775] (99.83 %) of epoch 14
2017-10-21 13:42:23,305 _log_validation: [1775] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 122.2 [121.6]
2017-10-21 13:42:23,305 set_state: Restored iterator to line 42008 of 42068.
2017-10-21 13:42:23,308 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-21 13:42:23,310 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-21 13:42:23,310 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-21 13:42:23,311 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
2017-10-21 13:42:23,311 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-21 13:42:23,312 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.125 to 0.0625 and resetting state to 100 % of epoch 14.
2017-10-21 13:42:23,313 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 4.2 minutes. Best validation perplexity 121.62.
2017-10-21 13:42:48,141 _log_update: [196] (11.0 %) of epoch 15 -- lr = 0.06, duration = 12.5 ms
2017-10-21 13:43:13,511 _log_update: [396] (22.3 %) of epoch 15 -- lr = 0.06, duration = 12.6 ms
2017-10-21 13:43:38,875 _log_update: [596] (33.5 %) of epoch 15 -- lr = 0.06, duration = 12.6 ms
2017-10-21 13:44:04,244 _log_update: [796] (44.8 %) of epoch 15 -- lr = 0.06, duration = 12.6 ms
2017-10-21 13:44:29,608 _log_update: [996] (56.0 %) of epoch 15 -- lr = 0.06, duration = 12.5 ms
2017-10-21 13:44:54,984 _log_update: [1196] (67.3 %) of epoch 15 -- lr = 0.06, duration = 12.6 ms
2017-10-21 13:45:20,358 _log_update: [1396] (78.5 %) of epoch 15 -- lr = 0.06, duration = 12.6 ms
2017-10-21 13:45:45,726 _log_update: [1596] (89.8 %) of epoch 15 -- lr = 0.06, duration = 12.6 ms
2017-10-21 13:46:11,739 _validate: [1772] First validation sample, perplexity 122.43.
2017-10-21 13:46:23,037 _validate: [1775] Center of validation, perplexity 122.50.
2017-10-21 13:46:34,347 _validate: [1778] Last validation sample, perplexity 122.21.
2017-10-21 13:46:34,347 _log_validation: [1778] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 122.2 [121.6] 122.4
2017-10-21 13:46:34,349 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-21 13:46:34,350 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-21 13:46:34,350 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-21 13:46:34,350 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-21 13:46:34,353 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-21 13:46:34,354 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-21 13:46:34,355 _reset_state: [1775] (99.83 %) of epoch 14
2017-10-21 13:46:34,355 _log_validation: [1775] Validation set cost history: 211.4 178.9 161.8 155.6 153.8 149.0 146.1 144.4 143.2 142.5 127.8 126.7 122.2 [121.6]
2017-10-21 13:46:34,356 set_state: Restored iterator to line 42008 of 42068.
2017-10-21 13:46:34,359 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-21 13:46:34,360 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-21 13:46:34,361 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-21 13:46:34,361 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
2017-10-21 13:46:34,362 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-21 13:46:34,362 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.0625 to 0.03125 and resetting state to 100 % of epoch 14.
Finished training epoch 14 in 0 hours 4.2 minutes. Best validation perplexity 121.62.
Training finished in 1 hours 19.7 minutes.
2017-10-21 13:46:34,364 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-21 13:46:34,365 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-21 13:46:34,365 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-21 13:46:34,366 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-21 13:46:34,369 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-21 13:46:34,369 set_state: layers/output_layer/input/b <- array(10001,)
Best validation set perplexity: 121.343250295
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.634507963373968
Perplexity: 102.97723695555823
