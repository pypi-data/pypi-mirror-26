/scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,contexts=dev0->cuda0;dev1->cuda1,optimizer_excluding=local_gpua_multinomial_wor,optimizer=None
Reading vocabulary from /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-10-26 13:34:56,915 train: TRAINING OPTIONS
2017-10-26 13:34:56,915 train: batch_size: 32
2017-10-26 13:34:56,915 train: sequence_length: 25
2017-10-26 13:34:56,915 train: validation_frequency: 1
2017-10-26 13:34:56,915 train: patience: 0
2017-10-26 13:34:56,915 train: stopping_criterion: no-improvement
2017-10-26 13:34:56,915 train: max_epochs: 15
2017-10-26 13:34:56,915 train: min_epochs: 1
2017-10-26 13:34:56,916 train: max_annealing_count: 0
2017-10-26 13:34:56,916 train: OPTIMIZATION OPTIONS
2017-10-26 13:34:56,916 train: method: adagrad
2017-10-26 13:34:56,916 train: epsilon: 1e-06
2017-10-26 13:34:56,916 train: gradient_decay_rate: 0.9
2017-10-26 13:34:56,916 train: sqr_gradient_decay_rate: 0.999
2017-10-26 13:34:56,916 train: learning_rate: 1.0
2017-10-26 13:34:56,916 train: weights: [ 1.]
2017-10-26 13:34:56,916 train: momentum: 0.9
2017-10-26 13:34:56,916 train: max_gradient_norm: 5.0
2017-10-26 13:34:56,917 train: num_noise_samples: 1
2017-10-26 13:34:56,917 train: noise_sharing: None
Creating trainer.
Computing the number of mini-batches in training data.
2017-10-26 13:34:59,392 __init__: One epoch of training data contains 1778 mini-batch updates.
2017-10-26 13:34:59,394 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-10-26 13:34:59,394 __init__: Finding sentence start positions in /scratch/elec/puhe/c/penn-treebank-project/ptb.train.txt.
2017-10-26 13:34:59,449 _reset: Generating a random order of input lines.
Building neural network.
2017-10-26 13:34:59,459 get_default_device: Context dev0 device="Tesla P100-PCIE-16GB" ID="0000:03:00.0"
2017-10-26 13:34:59,460 get_default_device: Context dev1 device="Tesla P100-PCIE-16GB" ID="0000:04:00.0"
2017-10-26 13:34:59,460 get_default_device: The first GPU device ("dev0") will be used as the default device.
2017-10-26 13:34:59,469 __init__: Creating layers.
2017-10-26 13:34:59,469 __init__: - NetworkInput name=word_input inputs=[] size=10001 activation=tanh devices=[]
2017-10-26 13:34:59,469 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 activation=tanh devices=[dev0, dev1]
2017-10-26 13:34:59,537 add:      * layers/projection_layer/W/dev0 size=500050 type=float32 device=dev0
2017-10-26 13:34:59,540 add:      * layers/projection_layer/W/dev1 size=500050 type=float32 device=dev1
2017-10-26 13:34:59,540 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 activation=tanh devices=[dev0]
2017-10-26 13:34:59,547 add:      * layers/hidden_layer/layer_input/W/dev0 size=102400 type=float32 device=dev0
2017-10-26 13:34:59,834 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-10-26 13:34:59,835 add:      * layers/hidden_layer/layer_input/b/dev0 size=1024 type=float32 device=dev0
2017-10-26 13:34:59,835 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 activation=tanh devices=[dev0, dev1]
2017-10-26 13:34:59,996 add:      * layers/output_layer/input/W/dev0 size=1280256 type=float32 device=dev0
2017-10-26 13:35:00,006 add:      * layers/output_layer/input/W/dev1 size=1280000 type=float32 device=dev1
2017-10-26 13:35:00,007 add:      * layers/output_layer/input/b/dev0 size=5001 type=float32 device=dev0
2017-10-26 13:35:00,008 add:      * layers/output_layer/input/b/dev1 size=5000 type=float32 device=dev1
2017-10-26 13:35:00,008 __init__: Total number of model parameters: 3935925
Building optimizer.
2017-10-26 13:35:00,194 add:      * layers/projection_layer/W/dev0_sum_sqr_gradient size=500050 type=float32 device=None
2017-10-26 13:35:00,195 add:      * layers/projection_layer/W/dev1_sum_sqr_gradient size=500050 type=float32 device=None
2017-10-26 13:35:00,195 add:      * layers/hidden_layer/layer_input/W/dev0_sum_sqr_gradient size=102400 type=float32 device=None
2017-10-26 13:35:00,196 add:      * layers/hidden_layer/step_input/W_sum_sqr_gradient size=262144 type=float32 device=None
2017-10-26 13:35:00,196 add:      * layers/hidden_layer/layer_input/b/dev0_sum_sqr_gradient size=1024 type=float32 device=None
2017-10-26 13:35:00,198 add:      * layers/output_layer/input/W/dev0_sum_sqr_gradient size=1280256 type=float32 device=None
2017-10-26 13:35:00,201 add:      * layers/output_layer/input/W/dev1_sum_sqr_gradient size=1280000 type=float32 device=None
2017-10-26 13:35:00,201 add:      * layers/output_layer/input/b/dev0_sum_sqr_gradient size=5001 type=float32 device=None
2017-10-26 13:35:00,202 add:      * layers/output_layer/input/b/dev1_sum_sqr_gradient size=5000 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /scratch/elec/puhe/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-10-26 13:37:25,420 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1, duration = 59.4 ms
2017-10-26 13:39:41,261 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1, duration = 59.4 ms
2017-10-26 13:41:57,184 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1, duration = 60.4 ms
2017-10-26 13:44:13,255 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1, duration = 59.7 ms
2017-10-26 13:46:28,180 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1, duration = 59.5 ms
2017-10-26 13:48:44,822 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1, duration = 68.4 ms
2017-10-26 13:50:55,598 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1, duration = 70.0 ms
2017-10-26 13:53:08,584 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1, duration = 59.7 ms
2017-10-26 13:55:43,542 _validate: [1772] First validation sample, perplexity 189.19.
2017-10-26 13:57:29,400 _validate: [1775] Center of validation, perplexity 189.32.
2017-10-26 13:59:13,926 _validate: [1778] Last validation sample, perplexity 187.94.
2017-10-26 13:59:14,020 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 13:59:14,021 _log_validation: [1778] Validation set cost history: [189.2]
2017-10-26 13:59:14,021 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 24.1 minutes. Best validation perplexity 189.19.
2017-10-26 13:59:30,071 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1, duration = 66.7 ms
2017-10-26 14:01:46,027 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1, duration = 69.3 ms
2017-10-26 14:04:02,402 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1, duration = 72.4 ms
2017-10-26 14:06:18,480 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1, duration = 69.5 ms
2017-10-26 14:08:34,435 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1, duration = 71.9 ms
2017-10-26 14:10:50,618 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1, duration = 71.7 ms
2017-10-26 14:13:05,154 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1, duration = 69.3 ms
2017-10-26 14:15:18,812 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1, duration = 60.6 ms
2017-10-26 14:17:30,916 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1, duration = 71.9 ms
2017-10-26 14:19:51,481 _validate: [1772] First validation sample, perplexity 160.81.
2017-10-26 14:21:37,404 _validate: [1775] Center of validation, perplexity 160.50.
2017-10-26 14:23:23,862 _validate: [1778] Last validation sample, perplexity 161.82.
2017-10-26 14:23:23,904 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 14:23:23,904 _log_validation: [1778] Validation set cost history: 189.2 [160.8]
2017-10-26 14:23:23,905 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 24.2 minutes. Best validation perplexity 160.81.
2017-10-26 14:23:52,568 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1, duration = 59.8 ms
2017-10-26 14:26:08,439 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1, duration = 60.6 ms
2017-10-26 14:28:24,201 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1, duration = 59.7 ms
2017-10-26 14:30:40,098 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1, duration = 59.7 ms
2017-10-26 14:32:56,163 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1, duration = 60.5 ms
2017-10-26 14:35:10,820 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1, duration = 59.8 ms
2017-10-26 14:37:27,600 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1, duration = 68.3 ms
2017-10-26 14:39:38,049 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1, duration = 66.7 ms
2017-10-26 14:41:50,655 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1, duration = 68.5 ms
2017-10-26 14:43:56,790 _validate: [1772] First validation sample, perplexity 148.45.
2017-10-26 14:45:41,352 _validate: [1775] Center of validation, perplexity 147.14.
2017-10-26 14:47:26,881 _validate: [1778] Last validation sample, perplexity 147.98.
2017-10-26 14:47:26,922 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 14:47:26,922 _log_validation: [1778] Validation set cost history: 189.2 160.8 [148.0]
2017-10-26 14:47:26,923 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 24.1 minutes. Best validation perplexity 147.97.
2017-10-26 14:48:11,735 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1, duration = 70.7 ms
2017-10-26 14:50:28,045 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1, duration = 70.8 ms
2017-10-26 14:52:44,239 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1, duration = 71.9 ms
2017-10-26 14:55:00,727 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1, duration = 70.9 ms
2017-10-26 14:57:17,089 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1, duration = 70.9 ms
2017-10-26 14:59:33,408 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1, duration = 71.1 ms
2017-10-26 15:01:49,651 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1, duration = 71.3 ms
2017-10-26 15:04:05,778 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1, duration = 71.1 ms
2017-10-26 15:06:18,957 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1, duration = 59.8 ms
2017-10-26 15:08:06,508 _validate: [1772] First validation sample, perplexity 140.69.
2017-10-26 15:09:49,046 _validate: [1775] Center of validation, perplexity 140.54.
2017-10-26 15:11:30,821 _validate: [1778] Last validation sample, perplexity 142.77.
2017-10-26 15:11:30,861 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 15:11:30,861 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 [140.7]
2017-10-26 15:11:30,862 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 24.1 minutes. Best validation perplexity 140.69.
2017-10-26 15:12:34,048 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1, duration = 88.7 ms
2017-10-26 15:14:51,103 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1, duration = 69.1 ms
2017-10-26 15:17:06,653 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1, duration = 69.0 ms
2017-10-26 15:19:22,158 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1, duration = 69.1 ms
2017-10-26 15:21:37,775 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1, duration = 69.2 ms
2017-10-26 15:23:53,096 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1, duration = 69.1 ms
2017-10-26 15:26:08,570 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1, duration = 68.8 ms
2017-10-26 15:28:24,074 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1, duration = 69.1 ms
2017-10-26 15:30:39,442 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1, duration = 68.8 ms
2017-10-26 15:32:11,638 _validate: [1772] First validation sample, perplexity 138.15.
2017-10-26 15:33:56,008 _validate: [1775] Center of validation, perplexity 138.90.
2017-10-26 15:35:41,281 _validate: [1778] Last validation sample, perplexity 139.68.
2017-10-26 15:35:41,321 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 15:35:41,322 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 [138.9]
2017-10-26 15:35:41,322 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 24.2 minutes. Best validation perplexity 138.90.
2017-10-26 15:36:51,975 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1, duration = 60.4 ms
2017-10-26 15:39:05,346 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1, duration = 64.0 ms
2017-10-26 15:41:24,380 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1, duration = 71.3 ms
2017-10-26 15:43:40,106 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1, duration = 71.9 ms
2017-10-26 15:45:55,829 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1, duration = 71.0 ms
2017-10-26 15:48:11,827 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1, duration = 71.0 ms
2017-10-26 15:50:27,916 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1, duration = 70.8 ms
2017-10-26 15:52:43,712 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1, duration = 71.0 ms
2017-10-26 15:54:59,372 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1, duration = 70.5 ms
2017-10-26 15:56:15,293 _validate: [1772] First validation sample, perplexity 136.21.
2017-10-26 15:57:59,117 _validate: [1775] Center of validation, perplexity 135.98.
2017-10-26 15:59:45,435 _validate: [1778] Last validation sample, perplexity 135.51.
2017-10-26 15:59:45,517 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 15:59:45,517 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 [136.0]
2017-10-26 15:59:45,518 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 24.1 minutes. Best validation perplexity 135.98.
2017-10-26 16:01:13,538 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1, duration = 69.2 ms
2017-10-26 16:03:29,519 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1, duration = 69.2 ms
2017-10-26 16:05:45,299 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1, duration = 69.2 ms
2017-10-26 16:08:00,822 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1, duration = 69.0 ms
2017-10-26 16:10:16,572 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1, duration = 68.7 ms
2017-10-26 16:12:32,272 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1, duration = 68.7 ms
2017-10-26 16:14:47,853 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1, duration = 69.2 ms
2017-10-26 16:17:03,531 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1, duration = 68.7 ms
2017-10-26 16:19:19,180 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1, duration = 68.7 ms
2017-10-26 16:20:21,522 _validate: [1772] First validation sample, perplexity 133.42.
2017-10-26 16:22:06,938 _validate: [1775] Center of validation, perplexity 133.00.
2017-10-26 16:23:50,913 _validate: [1778] Last validation sample, perplexity 133.57.
2017-10-26 16:23:50,956 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 16:23:50,956 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 [133.6]
2017-10-26 16:23:50,957 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 24.1 minutes. Best validation perplexity 133.57.
2017-10-26 16:25:34,377 _log_update: [154] (8.7 %) of epoch 8 -- lr = 1, duration = 72.5 ms
2017-10-26 16:27:50,650 _log_update: [354] (19.9 %) of epoch 8 -- lr = 1, duration = 65.7 ms
2017-10-26 16:29:59,834 _log_update: [554] (31.2 %) of epoch 8 -- lr = 1, duration = 58.8 ms
2017-10-26 16:32:19,548 _log_update: [754] (42.4 %) of epoch 8 -- lr = 1, duration = 71.3 ms
2017-10-26 16:34:35,517 _log_update: [954] (53.7 %) of epoch 8 -- lr = 1, duration = 71.0 ms
2017-10-26 16:36:51,503 _log_update: [1154] (64.9 %) of epoch 8 -- lr = 1, duration = 71.1 ms
2017-10-26 16:39:07,397 _log_update: [1354] (76.2 %) of epoch 8 -- lr = 1, duration = 70.8 ms
2017-10-26 16:41:23,337 _log_update: [1554] (87.4 %) of epoch 8 -- lr = 1, duration = 71.3 ms
2017-10-26 16:43:39,515 _log_update: [1754] (98.7 %) of epoch 8 -- lr = 1, duration = 71.5 ms
2017-10-26 16:44:25,191 _validate: [1772] First validation sample, perplexity 132.01.
2017-10-26 16:46:10,640 _validate: [1775] Center of validation, perplexity 132.20.
2017-10-26 16:47:55,336 _validate: [1778] Last validation sample, perplexity 131.08.
2017-10-26 16:47:55,388 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 16:47:55,389 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 [132.0]
2017-10-26 16:47:55,389 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 24.1 minutes. Best validation perplexity 132.00.
2017-10-26 16:49:53,571 _log_update: [176] (9.9 %) of epoch 9 -- lr = 1, duration = 66.2 ms
2017-10-26 16:51:59,575 _log_update: [376] (21.1 %) of epoch 9 -- lr = 1, duration = 73.0 ms
2017-10-26 16:54:21,685 _log_update: [576] (32.4 %) of epoch 9 -- lr = 1, duration = 67.6 ms
2017-10-26 16:56:37,350 _log_update: [776] (43.6 %) of epoch 9 -- lr = 1, duration = 68.7 ms
2017-10-26 16:58:53,091 _log_update: [976] (54.9 %) of epoch 9 -- lr = 1, duration = 69.0 ms
2017-10-26 17:01:08,872 _log_update: [1176] (66.1 %) of epoch 9 -- lr = 1, duration = 68.9 ms
2017-10-26 17:03:24,426 _log_update: [1376] (77.4 %) of epoch 9 -- lr = 1, duration = 68.9 ms
2017-10-26 17:05:40,204 _log_update: [1576] (88.6 %) of epoch 9 -- lr = 1, duration = 69.0 ms
2017-10-26 17:08:25,971 _validate: [1772] First validation sample, perplexity 132.15.
2017-10-26 17:10:11,448 _validate: [1775] Center of validation, perplexity 132.09.
2017-10-26 17:10:12,175 _log_update: [1776] (99.9 %) of epoch 9 -- lr = 1, duration = 67.9 ms
2017-10-26 17:11:53,368 _validate: [1778] Last validation sample, perplexity 132.97.
2017-10-26 17:11:53,369 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 [132.0] 132.2
2017-10-26 17:11:53,371 set_state: layers/projection_layer/W/dev0 <- array(10001, 50)
2017-10-26 17:11:53,373 set_state: layers/projection_layer/W/dev1 <- array(10001, 50)
2017-10-26 17:11:53,374 set_state: layers/hidden_layer/layer_input/W/dev0 <- array(100, 1024)
2017-10-26 17:11:53,375 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-26 17:11:53,375 set_state: layers/hidden_layer/layer_input/b/dev0 <- array(1024,)
2017-10-26 17:11:53,378 set_state: layers/output_layer/input/W/dev0 <- array(256, 5001)
2017-10-26 17:11:53,381 set_state: layers/output_layer/input/W/dev1 <- array(256, 5000)
2017-10-26 17:11:53,382 set_state: layers/output_layer/input/b/dev0 <- array(5001,)
2017-10-26 17:11:53,383 set_state: layers/output_layer/input/b/dev1 <- array(5000,)
2017-10-26 17:11:53,385 _reset_state: [1775] (99.83 %) of epoch 8
2017-10-26 17:11:53,386 _log_validation: [1775] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 [132.0]
2017-10-26 17:11:53,386 set_state: Restored iterator to line 41996 of 42068.
2017-10-26 17:11:53,388 set_state: layers/projection_layer/W/dev0_sum_sqr_gradient <- array(10001, 50)
2017-10-26 17:11:53,390 set_state: layers/projection_layer/W/dev1_sum_sqr_gradient <- array(10001, 50)
2017-10-26 17:11:53,390 set_state: layers/hidden_layer/layer_input/W/dev0_sum_sqr_gradient <- array(100, 1024)
2017-10-26 17:11:53,391 set_state: layers/hidden_layer/step_input/W_sum_sqr_gradient <- array(256, 1024)
2017-10-26 17:11:53,392 set_state: layers/hidden_layer/layer_input/b/dev0_sum_sqr_gradient <- array(1024,)
2017-10-26 17:11:53,395 set_state: layers/output_layer/input/W/dev0_sum_sqr_gradient <- array(256, 5001)
2017-10-26 17:11:53,398 set_state: layers/output_layer/input/W/dev1_sum_sqr_gradient <- array(256, 5000)
2017-10-26 17:11:53,399 set_state: layers/output_layer/input/b/dev0_sum_sqr_gradient <- array(5001,)
2017-10-26 17:11:53,399 set_state: layers/output_layer/input/b/dev1_sum_sqr_gradient <- array(5000,)
Model performance stopped improving. Decreasing learning rate from 1.0 to 0.5 and resetting state to 100 % of epoch 8.
2017-10-26 17:11:53,400 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 24.0 minutes. Best validation perplexity 132.00.
2017-10-26 17:14:05,252 _log_update: [198] (11.1 %) of epoch 9 -- lr = 0.5, duration = 60.8 ms
2017-10-26 17:16:24,072 _log_update: [398] (22.4 %) of epoch 9 -- lr = 0.5, duration = 70.9 ms
2017-10-26 17:18:39,363 _log_update: [598] (33.6 %) of epoch 9 -- lr = 0.5, duration = 70.8 ms
2017-10-26 17:20:54,695 _log_update: [798] (44.9 %) of epoch 9 -- lr = 0.5, duration = 71.1 ms
2017-10-26 17:23:10,046 _log_update: [998] (56.1 %) of epoch 9 -- lr = 0.5, duration = 71.0 ms
2017-10-26 17:25:25,552 _log_update: [1198] (67.4 %) of epoch 9 -- lr = 0.5, duration = 71.1 ms
2017-10-26 17:27:40,899 _log_update: [1398] (78.6 %) of epoch 9 -- lr = 0.5, duration = 71.2 ms
2017-10-26 17:29:53,172 _log_update: [1598] (89.9 %) of epoch 9 -- lr = 0.5, duration = 70.4 ms
2017-10-26 17:32:26,201 _validate: [1772] First validation sample, perplexity 125.09.
2017-10-26 17:34:08,914 _validate: [1775] Center of validation, perplexity 125.46.
2017-10-26 17:35:50,757 _validate: [1778] Last validation sample, perplexity 125.29.
2017-10-26 17:35:50,798 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 17:35:50,798 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 132.0 [125.3]
2017-10-26 17:35:50,799 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 24.0 minutes. Best validation perplexity 125.29.
2017-10-26 17:36:04,776 _log_update: [20] (1.1 %) of epoch 10 -- lr = 0.5, duration = 63.3 ms
2017-10-26 17:38:21,435 _log_update: [220] (12.4 %) of epoch 10 -- lr = 0.5, duration = 68.9 ms
2017-10-26 17:40:38,666 _log_update: [420] (23.6 %) of epoch 10 -- lr = 0.5, duration = 80.7 ms
2017-10-26 17:42:56,709 _log_update: [620] (34.9 %) of epoch 10 -- lr = 0.5, duration = 61.5 ms
2017-10-26 17:45:12,949 _log_update: [820] (46.1 %) of epoch 10 -- lr = 0.5, duration = 59.3 ms
2017-10-26 17:47:29,965 _log_update: [1020] (57.4 %) of epoch 10 -- lr = 0.5, duration = 67.0 ms
2017-10-26 17:49:47,870 _log_update: [1220] (68.6 %) of epoch 10 -- lr = 0.5, duration = 68.2 ms
2017-10-26 17:52:04,582 _log_update: [1420] (79.9 %) of epoch 10 -- lr = 0.5, duration = 59.5 ms
2017-10-26 17:54:21,556 _log_update: [1620] (91.1 %) of epoch 10 -- lr = 0.5, duration = 68.0 ms
2017-10-26 17:56:40,994 _validate: [1772] First validation sample, perplexity 126.73.
2017-10-26 17:58:23,992 _validate: [1775] Center of validation, perplexity 127.07.
2017-10-26 18:00:10,797 _validate: [1778] Last validation sample, perplexity 126.95.
2017-10-26 18:00:10,797 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 132.0 [125.3] 127.0
2017-10-26 18:00:10,799 set_state: layers/projection_layer/W/dev0 <- array(10001, 50)
2017-10-26 18:00:10,800 set_state: layers/projection_layer/W/dev1 <- array(10001, 50)
2017-10-26 18:00:10,801 set_state: layers/hidden_layer/layer_input/W/dev0 <- array(100, 1024)
2017-10-26 18:00:10,802 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-26 18:00:10,802 set_state: layers/hidden_layer/layer_input/b/dev0 <- array(1024,)
2017-10-26 18:00:10,804 set_state: layers/output_layer/input/W/dev0 <- array(256, 5001)
2017-10-26 18:00:10,806 set_state: layers/output_layer/input/W/dev1 <- array(256, 5000)
2017-10-26 18:00:10,806 set_state: layers/output_layer/input/b/dev0 <- array(5001,)
2017-10-26 18:00:10,807 set_state: layers/output_layer/input/b/dev1 <- array(5000,)
2017-10-26 18:00:10,809 _reset_state: [1775] (99.83 %) of epoch 9
2017-10-26 18:00:10,810 _log_validation: [1775] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 132.0 [125.3]
2017-10-26 18:00:10,810 set_state: Restored iterator to line 41996 of 42068.
2017-10-26 18:00:10,811 set_state: layers/projection_layer/W/dev0_sum_sqr_gradient <- array(10001, 50)
2017-10-26 18:00:10,812 set_state: layers/projection_layer/W/dev1_sum_sqr_gradient <- array(10001, 50)
2017-10-26 18:00:10,813 set_state: layers/hidden_layer/layer_input/W/dev0_sum_sqr_gradient <- array(100, 1024)
2017-10-26 18:00:10,814 set_state: layers/hidden_layer/step_input/W_sum_sqr_gradient <- array(256, 1024)
2017-10-26 18:00:10,814 set_state: layers/hidden_layer/layer_input/b/dev0_sum_sqr_gradient <- array(1024,)
2017-10-26 18:00:10,816 set_state: layers/output_layer/input/W/dev0_sum_sqr_gradient <- array(256, 5001)
2017-10-26 18:00:10,818 set_state: layers/output_layer/input/W/dev1_sum_sqr_gradient <- array(256, 5000)
2017-10-26 18:00:10,818 set_state: layers/output_layer/input/b/dev0_sum_sqr_gradient <- array(5001,)
2017-10-26 18:00:10,819 set_state: layers/output_layer/input/b/dev1_sum_sqr_gradient <- array(5000,)
Model performance stopped improving. Decreasing learning rate from 0.5 to 0.25 and resetting state to 100 % of epoch 9.
2017-10-26 18:00:10,820 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 24.3 minutes. Best validation perplexity 125.29.
2017-10-26 18:00:39,410 _log_update: [42] (2.4 %) of epoch 10 -- lr = 0.2, duration = 67.8 ms
2017-10-26 18:02:56,102 _log_update: [242] (13.6 %) of epoch 10 -- lr = 0.2, duration = 66.1 ms
2017-10-26 18:05:13,556 _log_update: [442] (24.9 %) of epoch 10 -- lr = 0.2, duration = 68.0 ms
2017-10-26 18:07:29,800 _log_update: [642] (36.1 %) of epoch 10 -- lr = 0.2, duration = 59.5 ms
2017-10-26 18:09:42,828 _log_update: [842] (47.4 %) of epoch 10 -- lr = 0.2, duration = 66.5 ms
2017-10-26 18:12:02,075 _log_update: [1042] (58.6 %) of epoch 10 -- lr = 0.2, duration = 67.7 ms
2017-10-26 18:14:18,646 _log_update: [1242] (69.9 %) of epoch 10 -- lr = 0.2, duration = 61.5 ms
2017-10-26 18:16:34,454 _log_update: [1442] (81.1 %) of epoch 10 -- lr = 0.2, duration = 59.6 ms
2017-10-26 18:18:47,534 _log_update: [1642] (92.4 %) of epoch 10 -- lr = 0.2, duration = 68.3 ms
2017-10-26 18:20:52,337 _validate: [1772] First validation sample, perplexity 124.62.
2017-10-26 18:22:37,614 _validate: [1775] Center of validation, perplexity 124.85.
2017-10-26 18:24:22,677 _validate: [1778] Last validation sample, perplexity 124.59.
2017-10-26 18:24:22,710 _set_candidate_state: New candidate for optimal state saved to /scratch/work/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-26 18:24:22,710 _log_validation: [1778] Validation set cost history: 189.2 160.8 148.0 140.7 138.9 136.0 133.6 132.0 125.3 [124.7]
2017-10-26 18:24:22,711 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 24.2 minutes. Best validation perplexity 124.71.
2017-10-26 18:25:05,372 _log_update: [64] (3.6 %) of epoch 11 -- lr = 0.2, duration = 64.9 ms
2017-10-26 18:27:21,235 _log_update: [264] (14.8 %) of epoch 11 -- lr = 0.2, duration = 64.8 ms
2017-10-26 18:29:36,710 _log_update: [464] (26.1 %) of epoch 11 -- lr = 0.2, duration = 67.1 ms
2017-10-26 18:31:52,475 _log_update: [664] (37.3 %) of epoch 11 -- lr = 0.2, duration = 62.3 ms
2017-10-26 18:34:08,173 _log_update: [864] (48.6 %) of epoch 11 -- lr = 0.2, duration = 59.5 ms
Computing evaluation set perplexity.
2017-10-26 18:41:43,191 get_default_device: Context dev0 device="Tesla P100-PCIE-16GB" ID="0000:03:00.0"
2017-10-26 18:41:43,191 get_default_device: Context dev1 device="Tesla P100-PCIE-16GB" ID="0000:04:00.0"
2017-10-26 18:41:43,192 get_default_device: The first GPU device ("dev0") will be used as the default device.
2017-10-26 18:41:43,194 from_file: Reading vocabulary from network state.
2017-10-26 18:41:43,278 from_file: Number of words in vocabulary: 10001
2017-10-26 18:41:43,279 from_file: Number of words in shortlist: 10001
2017-10-26 18:41:43,279 from_file: Number of word classes: 10001
2017-10-26 18:41:43,279 from_file: Building neural network.
2017-10-26 18:41:43,927 from_file: Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.653642186207011
Perplexity: 104.96659809911836
