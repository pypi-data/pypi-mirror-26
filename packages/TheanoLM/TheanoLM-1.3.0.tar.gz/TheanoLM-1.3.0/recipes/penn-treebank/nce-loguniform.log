/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0,optimizer_excluding=local_gpua_multinomial_wor
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-11-07 11:15:50,154 log_options: Training options:
2017-11-07 11:15:50,154 log_options:   batch_size: 24
2017-11-07 11:15:50,155 log_options:   max_annealing_count: 0
2017-11-07 11:15:50,155 log_options:   max_epochs: 15
2017-11-07 11:15:50,155 log_options:   min_epochs: 1
2017-11-07 11:15:50,155 log_options:   patience: 0
2017-11-07 11:15:50,155 log_options:   sequence_length: 25
2017-11-07 11:15:50,155 log_options:   stopping_criterion: no-improvement
2017-11-07 11:15:50,155 log_options:   validation_frequency: 1
2017-11-07 11:15:50,155 log_options: Optimization options:
2017-11-07 11:15:50,155 log_options:   epsilon=1e-06
2017-11-07 11:15:50,155 log_options:   gradient_decay_rate=0.9
2017-11-07 11:15:50,155 log_options:   learning_rate=20.0
2017-11-07 11:15:50,155 log_options:   max_gradient_norm=5.0
2017-11-07 11:15:50,155 log_options:   method=sgd
2017-11-07 11:15:50,156 log_options:   momentum=0.9
2017-11-07 11:15:50,156 log_options:   noise_sharing=None
2017-11-07 11:15:50,156 log_options:   num_noise_samples=25
2017-11-07 11:15:50,156 log_options:   sqr_gradient_decay_rate=0.999
2017-11-07 11:15:50,156 log_options:   weights=[ 1.]
2017-11-07 11:15:50,156 log_options:   cost_function=nce
2017-11-07 11:15:50,156 log_options:   noise_distribution=log-uniform
2017-11-07 11:15:50,156 log_options:   noise_dampening=0
2017-11-07 11:15:50,156 log_options:   noise_sharing=no
2017-11-07 11:15:50,157 log_options:   exclude_unk=no
2017-11-07 11:15:50,157 log_options:   l1_regularization=0.000000
2017-11-07 11:15:50,157 log_options:   l2_regularization=0.000000
2017-11-07 11:15:50,157 log_options: Data sampling: []
Creating trainer.
Computing the number of mini-batches in training data.
2017-11-07 11:15:51,755 __init__: One epoch of training data contains 2371 mini-batch updates.
2017-11-07 11:15:51,756 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-11-07 11:15:51,756 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-11-07 11:15:51,780 _reset: Generating a random order of input lines.
Building neural network.
2017-11-07 11:15:51,787 get_default_device: Context None device="Quadro K2000" ID="0000:01:00.0"
2017-11-07 11:15:51,794 __init__: Creating layers.
2017-11-07 11:15:51,795 __init__: - NetworkInput name=word_input inputs=[] size=10001 activation=tanh devices=[]
2017-11-07 11:15:51,795 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 activation=tanh devices=[None]
2017-11-07 11:15:51,835 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-11-07 11:15:51,835 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 activation=tanh devices=[None]
2017-11-07 11:15:51,840 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-11-07 11:15:51,906 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-11-07 11:15:51,906 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-11-07 11:15:51,906 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 activation=tanh devices=[None]
2017-11-07 11:15:52,013 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-11-07 11:15:52,013 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-11-07 11:15:52,013 __init__: Total number of model parameters: 3935925
Building optimizer.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-11-07 11:18:43,138 _log_update: [200] (8.4 %) of epoch 1 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:18:57,562 _log_update: [400] (16.9 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:19:11,989 _log_update: [600] (25.3 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:19:26,417 _log_update: [800] (33.7 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:19:40,844 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:19:55,274 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:20:09,701 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:20:24,127 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:20:38,552 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:20:52,974 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:21:07,401 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:21:23,215 _validate: [2365] First validation sample, perplexity 511.82.
2017-11-07 11:21:35,087 _validate: [2368] Center of validation, perplexity 513.85.
2017-11-07 11:21:47,022 _validate: [2371] Last validation sample, perplexity 518.47.
2017-11-07 11:21:47,041 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:21:47,041 _log_validation: [2371] Validation set cost history: [508.8]
2017-11-07 11:21:47,042 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.3 minutes. Best validation perplexity 508.79.
2017-11-07 11:21:49,109 _log_update: [29] (1.2 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:22:03,529 _log_update: [229] (9.7 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:22:17,950 _log_update: [429] (18.1 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:22:32,373 _log_update: [629] (26.5 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:22:46,795 _log_update: [829] (35.0 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:23:01,221 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:23:15,644 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:23:30,068 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:23:44,490 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:23:58,913 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:24:13,334 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:24:27,759 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:24:41,481 _validate: [2365] First validation sample, perplexity 362.44.
2017-11-07 11:24:53,342 _validate: [2368] Center of validation, perplexity 373.94.
2017-11-07 11:25:05,207 _validate: [2371] Last validation sample, perplexity 377.73.
2017-11-07 11:25:05,215 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:25:05,215 _log_validation: [2371] Validation set cost history: 508.8 [369.9]
2017-11-07 11:25:05,216 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.3 minutes. Best validation perplexity 369.87.
2017-11-07 11:25:09,374 _log_update: [58] (2.4 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:25:23,795 _log_update: [258] (10.9 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:25:38,215 _log_update: [458] (19.3 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:25:52,634 _log_update: [658] (27.8 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:26:07,054 _log_update: [858] (36.2 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:26:21,470 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:26:35,888 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:26:50,306 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:27:04,725 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:27:19,146 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:27:33,566 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:27:47,988 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:27:59,617 _validate: [2365] First validation sample, perplexity 335.94.
2017-11-07 11:28:11,475 _validate: [2368] Center of validation, perplexity 333.70.
2017-11-07 11:28:23,323 _validate: [2371] Last validation sample, perplexity 343.94.
2017-11-07 11:28:23,331 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:28:23,331 _log_validation: [2371] Validation set cost history: 508.8 369.9 [338.1]
2017-11-07 11:28:23,331 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.3 minutes. Best validation perplexity 338.09.
2017-11-07 11:28:29,583 _log_update: [87] (3.7 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:28:44,004 _log_update: [287] (12.1 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:28:58,421 _log_update: [487] (20.5 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:29:12,838 _log_update: [687] (29.0 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:29:27,259 _log_update: [887] (37.4 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:29:41,675 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:29:56,093 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:30:10,514 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:30:24,936 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:30:39,353 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:30:53,772 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:31:08,193 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:31:17,725 _validate: [2365] First validation sample, perplexity 307.72.
2017-11-07 11:31:29,574 _validate: [2368] Center of validation, perplexity 311.47.
2017-11-07 11:31:41,424 _validate: [2371] Last validation sample, perplexity 318.19.
2017-11-07 11:31:41,432 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:31:41,432 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 [311.5]
2017-11-07 11:31:41,432 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.3 minutes. Best validation perplexity 311.47.
2017-11-07 11:31:49,771 _log_update: [116] (4.9 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:32:04,192 _log_update: [316] (13.3 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:32:18,614 _log_update: [516] (21.8 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:32:33,035 _log_update: [716] (30.2 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:32:47,454 _log_update: [916] (38.6 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:33:01,873 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:33:16,289 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:33:30,711 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:33:45,127 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:33:59,546 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:34:13,967 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:34:28,386 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:34:35,831 _validate: [2365] First validation sample, perplexity 294.06.
2017-11-07 11:34:47,687 _validate: [2368] Center of validation, perplexity 290.23.
2017-11-07 11:34:59,541 _validate: [2371] Last validation sample, perplexity 293.04.
2017-11-07 11:34:59,549 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:34:59,549 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 [291.2]
2017-11-07 11:34:59,549 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.3 minutes. Best validation perplexity 291.21.
2017-11-07 11:35:09,982 _log_update: [145] (6.1 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:35:24,400 _log_update: [345] (14.6 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:35:38,818 _log_update: [545] (23.0 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:35:53,236 _log_update: [745] (31.4 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:36:07,656 _log_update: [945] (39.9 %) of epoch 6 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:36:22,074 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:36:36,494 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:36:50,913 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:37:05,331 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:37:19,750 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:37:34,165 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:37:48,585 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:37:53,936 _validate: [2365] First validation sample, perplexity 280.23.
2017-11-07 11:38:05,789 _validate: [2368] Center of validation, perplexity 317.51.
2017-11-07 11:38:17,641 _validate: [2371] Last validation sample, perplexity 279.73.
2017-11-07 11:38:17,649 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:38:17,649 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 [286.1]
2017-11-07 11:38:17,650 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.3 minutes. Best validation perplexity 286.12.
2017-11-07 11:38:30,168 _log_update: [174] (7.3 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:38:44,587 _log_update: [374] (15.8 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:38:59,005 _log_update: [574] (24.2 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:39:13,423 _log_update: [774] (32.6 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:39:27,842 _log_update: [974] (41.1 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:39:42,261 _log_update: [1174] (49.5 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:39:56,683 _log_update: [1374] (58.0 %) of epoch 7 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:40:11,104 _log_update: [1574] (66.4 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:40:25,518 _log_update: [1774] (74.8 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:40:39,939 _log_update: [1974] (83.3 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:40:54,357 _log_update: [2174] (91.7 %) of epoch 7 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:41:12,038 _validate: [2365] First validation sample, perplexity 286.98.
2017-11-07 11:41:23,889 _validate: [2368] Center of validation, perplexity 272.62.
2017-11-07 11:41:35,741 _validate: [2371] Last validation sample, perplexity 277.14.
2017-11-07 11:41:35,749 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:41:35,749 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 [275.2]
2017-11-07 11:41:35,750 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.3 minutes. Best validation perplexity 275.21.
2017-11-07 11:41:35,942 _log_update: [3] (0.1 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:41:50,359 _log_update: [203] (8.6 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:42:04,779 _log_update: [403] (17.0 %) of epoch 8 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:42:19,194 _log_update: [603] (25.4 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:42:33,612 _log_update: [803] (33.9 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:42:48,028 _log_update: [1003] (42.3 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:43:02,447 _log_update: [1203] (50.7 %) of epoch 8 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:43:16,864 _log_update: [1403] (59.2 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:43:31,282 _log_update: [1603] (67.6 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:43:45,699 _log_update: [1803] (76.0 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:44:00,121 _log_update: [2003] (84.5 %) of epoch 8 -- lr = 2e+01, duration = 7.1 ms
2017-11-07 11:44:14,542 _log_update: [2203] (92.9 %) of epoch 8 -- lr = 2e+01, duration = 7.2 ms
2017-11-07 11:44:30,134 _validate: [2365] First validation sample, perplexity 274.53.
2017-11-07 11:44:41,986 _validate: [2368] Center of validation, perplexity 274.58.
2017-11-07 11:44:53,837 _validate: [2371] Last validation sample, perplexity 288.12.
2017-11-07 11:44:53,837 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 [275.2] 277.1
2017-11-07 11:44:53,839 set_state: layers/projection_layer/W <- array(10001, 100)
2017-11-07 11:44:53,840 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-11-07 11:44:53,840 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-11-07 11:44:53,841 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-11-07 11:44:53,844 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-11-07 11:44:53,844 set_state: layers/output_layer/input/b <- array(10001,)
2017-11-07 11:44:53,846 _reset_state: [2368] (99.87 %) of epoch 7
2017-11-07 11:44:53,846 _log_validation: [2368] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 [275.2]
2017-11-07 11:44:53,846 set_state: Restored iterator to line 42024 of 42068.
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 7.
2017-11-07 11:44:53,847 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.3 minutes. Best validation perplexity 275.21.
2017-11-07 11:44:56,129 _log_update: [32] (1.3 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:45:10,553 _log_update: [232] (9.8 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:45:24,973 _log_update: [432] (18.2 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:45:39,387 _log_update: [632] (26.7 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:45:53,805 _log_update: [832] (35.1 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:46:08,221 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 1e+01, duration = 7.2 ms
2017-11-07 11:46:22,637 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 1e+01, duration = 7.2 ms
2017-11-07 11:46:37,054 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:46:51,468 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:47:05,887 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:47:20,302 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:47:34,720 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 1e+01, duration = 7.2 ms
2017-11-07 11:47:48,219 _validate: [2365] First validation sample, perplexity 254.43.
2017-11-07 11:48:00,068 _validate: [2368] Center of validation, perplexity 255.24.
2017-11-07 11:48:11,922 _validate: [2371] Last validation sample, perplexity 255.23.
2017-11-07 11:48:11,931 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:48:11,931 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 [255.1]
2017-11-07 11:48:11,931 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.3 minutes. Best validation perplexity 255.06.
2017-11-07 11:48:16,306 _log_update: [61] (2.6 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:48:30,724 _log_update: [261] (11.0 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:48:45,141 _log_update: [461] (19.4 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:48:59,559 _log_update: [661] (27.9 %) of epoch 9 -- lr = 1e+01, duration = 7.2 ms
2017-11-07 11:49:13,979 _log_update: [861] (36.3 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:49:28,395 _log_update: [1061] (44.7 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:49:42,814 _log_update: [1261] (53.2 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:49:57,231 _log_update: [1461] (61.6 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:50:11,651 _log_update: [1661] (70.1 %) of epoch 9 -- lr = 1e+01, duration = 7.2 ms
2017-11-07 11:50:26,066 _log_update: [1861] (78.5 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:50:40,484 _log_update: [2061] (86.9 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:50:54,902 _log_update: [2261] (95.4 %) of epoch 9 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:51:06,314 _validate: [2365] First validation sample, perplexity 245.26.
2017-11-07 11:51:18,164 _validate: [2368] Center of validation, perplexity 243.54.
2017-11-07 11:51:30,014 _validate: [2371] Last validation sample, perplexity 245.39.
2017-11-07 11:51:30,022 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:51:30,022 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 [243.7]
2017-11-07 11:51:30,022 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.3 minutes. Best validation perplexity 243.74.
2017-11-07 11:51:36,487 _log_update: [90] (3.8 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:51:50,901 _log_update: [290] (12.2 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:52:05,322 _log_update: [490] (20.7 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:52:19,738 _log_update: [690] (29.1 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:52:34,156 _log_update: [890] (37.5 %) of epoch 10 -- lr = 1e+01, duration = 7.2 ms
2017-11-07 11:52:48,575 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:53:02,993 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:53:17,409 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:53:31,829 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:53:46,246 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:54:00,661 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:54:15,079 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 1e+01, duration = 7.1 ms
2017-11-07 11:54:24,393 _validate: [2365] First validation sample, perplexity 249.65.
2017-11-07 11:54:36,244 _validate: [2368] Center of validation, perplexity 244.17.
2017-11-07 11:54:48,093 _validate: [2371] Last validation sample, perplexity 246.14.
2017-11-07 11:54:48,093 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 [243.7] 246.1
2017-11-07 11:54:48,095 set_state: layers/projection_layer/W <- array(10001, 100)
2017-11-07 11:54:48,095 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-11-07 11:54:48,096 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-11-07 11:54:48,096 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-11-07 11:54:48,099 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-11-07 11:54:48,100 set_state: layers/output_layer/input/b <- array(10001,)
2017-11-07 11:54:48,101 _reset_state: [2368] (99.87 %) of epoch 9
2017-11-07 11:54:48,101 _log_validation: [2368] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 [243.7]
2017-11-07 11:54:48,102 set_state: Restored iterator to line 42019 of 42068.
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 9.
2017-11-07 11:54:48,105 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.3 minutes. Best validation perplexity 243.74.
2017-11-07 11:54:56,658 _log_update: [119] (5.0 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:55:11,076 _log_update: [319] (13.5 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:55:25,495 _log_update: [519] (21.9 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:55:39,909 _log_update: [719] (30.3 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:55:54,329 _log_update: [919] (38.8 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:56:08,747 _log_update: [1119] (47.2 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:56:23,165 _log_update: [1319] (55.6 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:56:37,580 _log_update: [1519] (64.1 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:56:51,995 _log_update: [1719] (72.5 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:57:06,412 _log_update: [1919] (80.9 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:57:20,828 _log_update: [2119] (89.4 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:57:35,246 _log_update: [2319] (97.8 %) of epoch 10 -- lr = 5, duration = 7.1 ms
2017-11-07 11:57:42,472 _validate: [2365] First validation sample, perplexity 236.23.
2017-11-07 11:57:54,321 _validate: [2368] Center of validation, perplexity 236.94.
2017-11-07 11:58:06,175 _validate: [2371] Last validation sample, perplexity 237.27.
2017-11-07 11:58:06,186 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 11:58:06,186 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 [237.1]
2017-11-07 11:58:06,186 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.3 minutes. Best validation perplexity 237.10.
2017-11-07 11:58:16,831 _log_update: [148] (6.2 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:58:31,248 _log_update: [348] (14.7 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:58:45,662 _log_update: [548] (23.1 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:59:00,078 _log_update: [748] (31.5 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:59:14,496 _log_update: [948] (40.0 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:59:28,912 _log_update: [1148] (48.4 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:59:43,328 _log_update: [1348] (56.9 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 11:59:57,745 _log_update: [1548] (65.3 %) of epoch 11 -- lr = 5, duration = 7.2 ms
2017-11-07 12:00:12,163 _log_update: [1748] (73.7 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 12:00:26,580 _log_update: [1948] (82.2 %) of epoch 11 -- lr = 5, duration = 7.2 ms
2017-11-07 12:00:40,994 _log_update: [2148] (90.6 %) of epoch 11 -- lr = 5, duration = 7.2 ms
2017-11-07 12:00:55,411 _log_update: [2348] (99.0 %) of epoch 11 -- lr = 5, duration = 7.1 ms
2017-11-07 12:01:00,547 _validate: [2365] First validation sample, perplexity 236.23.
2017-11-07 12:01:12,401 _validate: [2368] Center of validation, perplexity 234.65.
2017-11-07 12:01:24,250 _validate: [2371] Last validation sample, perplexity 235.68.
2017-11-07 12:01:24,260 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 12:01:24,260 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 [235.0]
2017-11-07 12:01:24,260 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.3 minutes. Best validation perplexity 235.04.
2017-11-07 12:01:36,993 _log_update: [177] (7.5 %) of epoch 12 -- lr = 5, duration = 7.2 ms
2017-11-07 12:01:51,413 _log_update: [377] (15.9 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:02:05,832 _log_update: [577] (24.3 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:02:20,247 _log_update: [777] (32.8 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:02:34,665 _log_update: [977] (41.2 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:02:49,081 _log_update: [1177] (49.6 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:03:03,498 _log_update: [1377] (58.1 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:03:17,918 _log_update: [1577] (66.5 %) of epoch 12 -- lr = 5, duration = 7.3 ms
2017-11-07 12:03:32,437 _log_update: [1777] (74.9 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:03:46,949 _log_update: [1977] (83.4 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:04:01,364 _log_update: [2177] (91.8 %) of epoch 12 -- lr = 5, duration = 7.1 ms
2017-11-07 12:04:18,827 _validate: [2365] First validation sample, perplexity 233.07.
2017-11-07 12:04:30,676 _validate: [2368] Center of validation, perplexity 233.07.
2017-11-07 12:04:42,531 _validate: [2371] Last validation sample, perplexity 233.61.
2017-11-07 12:04:42,541 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 12:04:42,541 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 235.0 [233.1]
2017-11-07 12:04:42,541 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 3.3 minutes. Best validation perplexity 233.07.
2017-11-07 12:04:42,949 _log_update: [6] (0.3 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:04:57,364 _log_update: [206] (8.7 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:05:11,784 _log_update: [406] (17.1 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:05:26,199 _log_update: [606] (25.6 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:05:40,618 _log_update: [806] (34.0 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:05:55,034 _log_update: [1006] (42.4 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:06:09,449 _log_update: [1206] (50.9 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:06:23,864 _log_update: [1406] (59.3 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:06:38,277 _log_update: [1606] (67.7 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:06:52,693 _log_update: [1806] (76.2 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:07:07,107 _log_update: [2006] (84.6 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:07:21,525 _log_update: [2206] (93.0 %) of epoch 13 -- lr = 5, duration = 7.1 ms
2017-11-07 12:07:36,894 _validate: [2365] First validation sample, perplexity 231.43.
2017-11-07 12:07:48,744 _validate: [2368] Center of validation, perplexity 230.23.
2017-11-07 12:08:00,594 _validate: [2371] Last validation sample, perplexity 230.68.
2017-11-07 12:08:00,604 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 12:08:00,604 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 235.0 233.1 [230.2]
2017-11-07 12:08:00,604 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.3 minutes. Best validation perplexity 230.24.
2017-11-07 12:08:03,103 _log_update: [35] (1.5 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:08:17,521 _log_update: [235] (9.9 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:08:31,938 _log_update: [435] (18.3 %) of epoch 14 -- lr = 5, duration = 7.2 ms
2017-11-07 12:08:46,355 _log_update: [635] (26.8 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:09:00,775 _log_update: [835] (35.2 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:09:15,193 _log_update: [1035] (43.7 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:09:29,611 _log_update: [1235] (52.1 %) of epoch 14 -- lr = 5, duration = 7.2 ms
2017-11-07 12:09:44,025 _log_update: [1435] (60.5 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:09:58,442 _log_update: [1635] (69.0 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:10:12,863 _log_update: [1835] (77.4 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:10:27,281 _log_update: [2035] (85.8 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:10:41,698 _log_update: [2235] (94.3 %) of epoch 14 -- lr = 5, duration = 7.1 ms
2017-11-07 12:10:54,984 _validate: [2365] First validation sample, perplexity 237.09.
2017-11-07 12:11:06,849 _validate: [2368] Center of validation, perplexity 237.33.
2017-11-07 12:11:18,698 _validate: [2371] Last validation sample, perplexity 238.25.
2017-11-07 12:11:18,699 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 235.0 233.1 [230.2] 237.2
2017-11-07 12:11:18,700 set_state: layers/projection_layer/W <- array(10001, 100)
2017-11-07 12:11:18,701 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-11-07 12:11:18,701 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-11-07 12:11:18,702 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-11-07 12:11:18,705 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-11-07 12:11:18,705 set_state: layers/output_layer/input/b <- array(10001,)
2017-11-07 12:11:18,707 _reset_state: [2368] (99.87 %) of epoch 13
2017-11-07 12:11:18,707 _log_validation: [2368] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 235.0 233.1 [230.2]
2017-11-07 12:11:18,707 set_state: Restored iterator to line 42023 of 42068.
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 13.
2017-11-07 12:11:18,709 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.3 minutes. Best validation perplexity 230.24.
2017-11-07 12:11:23,297 _log_update: [64] (2.7 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:11:37,717 _log_update: [264] (11.1 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:11:52,137 _log_update: [464] (19.6 %) of epoch 14 -- lr = 2, duration = 7.2 ms
2017-11-07 12:12:06,554 _log_update: [664] (28.0 %) of epoch 14 -- lr = 2, duration = 7.2 ms
2017-11-07 12:12:20,971 _log_update: [864] (36.4 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:12:35,387 _log_update: [1064] (44.9 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:12:49,804 _log_update: [1264] (53.3 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:13:04,219 _log_update: [1464] (61.7 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:13:18,636 _log_update: [1664] (70.2 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:13:33,054 _log_update: [1864] (78.6 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:13:47,472 _log_update: [2064] (87.1 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:14:01,890 _log_update: [2264] (95.5 %) of epoch 14 -- lr = 2, duration = 7.1 ms
2017-11-07 12:14:13,080 _validate: [2365] First validation sample, perplexity 228.82.
2017-11-07 12:14:24,929 _validate: [2368] Center of validation, perplexity 229.03.
2017-11-07 12:14:36,780 _validate: [2371] Last validation sample, perplexity 229.03.
2017-11-07 12:14:36,790 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 12:14:36,790 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 235.0 233.1 230.2 [229.0]
2017-11-07 12:14:36,790 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 3.3 minutes. Best validation perplexity 228.97.
2017-11-07 12:14:43,467 _log_update: [93] (3.9 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:14:57,883 _log_update: [293] (12.4 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:15:12,297 _log_update: [493] (20.8 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:15:26,714 _log_update: [693] (29.2 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:15:41,132 _log_update: [893] (37.7 %) of epoch 15 -- lr = 2, duration = 7.2 ms
2017-11-07 12:15:55,548 _log_update: [1093] (46.1 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:16:09,966 _log_update: [1293] (54.5 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:16:24,381 _log_update: [1493] (63.0 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:16:38,800 _log_update: [1693] (71.4 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:16:53,216 _log_update: [1893] (79.8 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:17:07,633 _log_update: [2093] (88.3 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:17:22,052 _log_update: [2293] (96.7 %) of epoch 15 -- lr = 2, duration = 7.1 ms
2017-11-07 12:17:31,151 _validate: [2365] First validation sample, perplexity 227.68.
2017-11-07 12:17:43,002 _validate: [2368] Center of validation, perplexity 227.77.
2017-11-07 12:17:54,857 _validate: [2371] Last validation sample, perplexity 227.88.
2017-11-07 12:17:54,867 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-11-07 12:17:54,867 _log_validation: [2371] Validation set cost history: 508.8 369.9 338.1 311.5 291.2 286.1 275.2 255.1 243.7 237.1 235.0 233.1 230.2 229.0 [227.7]
2017-11-07 12:17:54,868 _reset: Generating a random order of input lines.
Finished training epoch 15 in 0 hours 3.3 minutes. Best validation perplexity 227.68.
Stopping because 15 epochs was reached.
Training finished in 0 hours 59.5 minutes.
2017-11-07 12:17:54,876 set_state: layers/projection_layer/W <- array(10001, 100)
2017-11-07 12:17:54,876 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-11-07 12:17:54,877 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-11-07 12:17:54,877 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-11-07 12:17:54,880 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-11-07 12:17:54,881 set_state: layers/output_layer/input/b <- array(10001,)
Best validation set perplexity: 227.772431837
train finished.
Computing evaluation set perplexity.
2017-11-07 12:18:12,019 get_default_device: Theano is not using a GPU or an old version of libgpuarray is installed.
2017-11-07 12:18:12,020 from_file: Reading vocabulary from network state.
2017-11-07 12:18:12,097 from_file: Number of words in vocabulary: 10001
2017-11-07 12:18:12,097 from_file: Number of words in shortlist: 10001
2017-11-07 12:18:12,097 from_file: Number of word classes: 10001
2017-11-07 12:18:12,097 from_file: Building neural network.
2017-11-07 12:18:12,532 from_file: Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 5.214188426458269
Perplexity: 183.86254243782471
