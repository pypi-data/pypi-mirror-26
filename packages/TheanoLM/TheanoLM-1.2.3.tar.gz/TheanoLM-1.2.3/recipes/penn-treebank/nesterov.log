/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0,optimizer_excluding=local_gpua_multinomial_wor
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-10-18 11:00:46,491 train: TRAINING OPTIONS
2017-10-18 11:00:46,491 train: max_annealing_count: 0
2017-10-18 11:00:46,491 train: batch_size: 32
2017-10-18 11:00:46,492 train: min_epochs: 1
2017-10-18 11:00:46,492 train: patience: 0
2017-10-18 11:00:46,492 train: max_epochs: 15
2017-10-18 11:00:46,492 train: validation_frequency: 1
2017-10-18 11:00:46,492 train: sequence_length: 25
2017-10-18 11:00:46,492 train: stopping_criterion: no-improvement
2017-10-18 11:00:46,492 train: OPTIMIZATION OPTIONS
2017-10-18 11:00:46,492 train: noise_sharing: None
2017-10-18 11:00:46,492 train: gradient_decay_rate: 0.9
2017-10-18 11:00:46,492 train: max_gradient_norm: 5.0
2017-10-18 11:00:46,492 train: momentum: 0.9
2017-10-18 11:00:46,492 train: learning_rate: 1.0
2017-10-18 11:00:46,492 train: weights: [ 1.]
2017-10-18 11:00:46,492 train: method: nesterov
2017-10-18 11:00:46,493 train: sqr_gradient_decay_rate: 0.999
2017-10-18 11:00:46,493 train: epsilon: 1e-06
2017-10-18 11:00:46,493 train: num_noise_samples: 1
Creating trainer.
Computing the number of mini-batches in training data.
2017-10-18 11:00:48,064 __init__: One epoch of training data contains 1778 mini-batch updates.
2017-10-18 11:00:48,065 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-10-18 11:00:48,067 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-10-18 11:00:48,091 _reset: Generating a random order of input lines.
Building neural network.
2017-10-18 11:00:48,129 __init__: Creating layers.
2017-10-18 11:00:48,129 __init__: - NetworkInput name=word_input inputs=[] size=10001 activation=tanh devices=[]
2017-10-18 11:00:48,129 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 activation=tanh devices=[None]
2017-10-18 11:00:48,209 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-10-18 11:00:48,210 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 activation=tanh devices=[None]
2017-10-18 11:00:48,218 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-10-18 11:00:48,723 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-10-18 11:00:48,724 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-10-18 11:00:48,724 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 activation=tanh devices=[None]
2017-10-18 11:00:48,970 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-10-18 11:00:48,971 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-10-18 11:00:48,971 __init__: Total number of model parameters: 3935925
Building optimizer.
2017-10-18 11:00:51,574 add:      * layers/hidden_layer/layer_input/b_velocity size=1024 type=float32 device=None
2017-10-18 11:00:51,574 add:      * layers/hidden_layer/layer_input/W_velocity size=102400 type=float32 device=None
2017-10-18 11:00:51,577 add:      * layers/projection_layer/W_velocity size=1000100 type=float32 device=None
2017-10-18 11:00:51,577 add:      * layers/hidden_layer/step_input/W_velocity size=262144 type=float32 device=None
2017-10-18 11:00:51,577 add:      * layers/output_layer/input/b_velocity size=10001 type=float32 device=None
2017-10-18 11:00:51,583 add:      * layers/output_layer/input/W_velocity size=2560256 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-10-18 11:01:51,883 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:02:16,360 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:02:40,826 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:03:05,297 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2017-10-18 11:03:29,977 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:03:54,698 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:04:19,168 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:04:43,633 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2017-10-18 11:05:08,359 _validate: [1772] First validation sample, perplexity 290.76.
2017-10-18 11:05:19,669 _validate: [1775] Center of validation, perplexity 289.04.
2017-10-18 11:05:31,087 _validate: [1778] Last validation sample, perplexity 288.01.
2017-10-18 11:05:31,112 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:05:31,112 _log_validation: [1778] Validation set cost history: [289.0]
2017-10-18 11:05:31,113 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 4.1 minutes. Best validation perplexity 289.04.
2017-10-18 11:05:33,773 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:05:58,244 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:06:22,727 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:06:47,200 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:07:11,677 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:07:36,141 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:08:00,608 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:08:25,075 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:08:49,540 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1, duration = 12.1 ms
2017-10-18 11:09:11,589 _validate: [1772] First validation sample, perplexity 201.62.
2017-10-18 11:09:22,901 _validate: [1775] Center of validation, perplexity 202.44.
2017-10-18 11:09:34,236 _validate: [1778] Last validation sample, perplexity 203.17.
2017-10-18 11:09:34,255 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:09:34,255 _log_validation: [1778] Validation set cost history: 289.0 [202.4]
2017-10-18 11:09:34,256 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 4.1 minutes. Best validation perplexity 202.44.
2017-10-18 11:09:39,609 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:10:04,160 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:10:28,661 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1, duration = 12.2 ms
2017-10-18 11:10:53,160 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:11:17,677 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:11:42,176 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:12:06,683 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:12:31,183 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:12:55,681 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1, duration = 12.1 ms
2017-10-18 11:13:15,055 _validate: [1772] First validation sample, perplexity 172.03.
2017-10-18 11:13:26,368 _validate: [1775] Center of validation, perplexity 172.87.
2017-10-18 11:13:37,696 _validate: [1778] Last validation sample, perplexity 171.82.
2017-10-18 11:13:37,714 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:13:37,714 _log_validation: [1778] Validation set cost history: 289.0 202.4 [172.1]
2017-10-18 11:13:37,714 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 4.1 minutes. Best validation perplexity 172.10.
2017-10-18 11:13:45,768 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:14:10,279 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:14:34,779 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:14:59,277 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:15:23,781 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:15:48,280 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:16:12,807 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:16:37,308 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:17:01,814 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1, duration = 12.1 ms
2017-10-18 11:17:18,498 _validate: [1772] First validation sample, perplexity 162.48.
2017-10-18 11:17:29,810 _validate: [1775] Center of validation, perplexity 162.87.
2017-10-18 11:17:41,139 _validate: [1778] Last validation sample, perplexity 161.08.
2017-10-18 11:17:41,157 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:17:41,157 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 [162.5]
2017-10-18 11:17:41,157 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 4.1 minutes. Best validation perplexity 162.48.
2017-10-18 11:17:51,903 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:18:16,410 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:18:40,909 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:19:05,411 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:19:29,909 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:19:54,414 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:20:18,920 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:20:43,418 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:21:07,933 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1, duration = 12.1 ms
2017-10-18 11:21:21,911 _validate: [1772] First validation sample, perplexity 152.36.
2017-10-18 11:21:33,220 _validate: [1775] Center of validation, perplexity 152.07.
2017-10-18 11:21:44,550 _validate: [1778] Last validation sample, perplexity 150.93.
2017-10-18 11:21:44,567 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:21:44,567 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 162.5 [152.1]
2017-10-18 11:21:44,568 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 4.1 minutes. Best validation perplexity 152.07.
2017-10-18 11:21:58,002 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:22:22,493 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:22:46,978 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:23:11,473 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:23:35,959 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:24:00,451 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:24:24,941 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:24:49,431 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:25:13,926 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1, duration = 12.1 ms
2017-10-18 11:25:25,201 _validate: [1772] First validation sample, perplexity 150.90.
2017-10-18 11:25:36,511 _validate: [1775] Center of validation, perplexity 150.58.
2017-10-18 11:25:47,840 _validate: [1778] Last validation sample, perplexity 151.35.
2017-10-18 11:25:47,857 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:25:47,858 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 [150.7]
2017-10-18 11:25:47,858 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.1 minutes. Best validation perplexity 150.74.
2017-10-18 11:26:03,999 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:26:28,495 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:26:52,986 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:27:17,485 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:27:41,978 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:28:06,486 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:28:30,977 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:28:55,468 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:29:19,971 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1, duration = 12.1 ms
2017-10-18 11:29:28,558 _validate: [1772] First validation sample, perplexity 150.77.
2017-10-18 11:29:39,871 _validate: [1775] Center of validation, perplexity 151.39.
2017-10-18 11:29:51,200 _validate: [1778] Last validation sample, perplexity 150.32.
2017-10-18 11:29:51,200 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 [150.7] 151.4
2017-10-18 11:29:51,202 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 11:29:51,202 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 11:29:51,203 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 11:29:51,203 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 11:29:51,203 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 11:29:51,207 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-18 11:29:51,208 _reset_state: [1775] (99.83 %) of epoch 6
2017-10-18 11:29:51,208 _log_validation: [1775] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 [150.7]
2017-10-18 11:29:51,209 set_state: Restored iterator to line 41995 of 42068.
2017-10-18 11:29:51,209 set_state: layers/output_layer/input/b_velocity <- array(10001,)
2017-10-18 11:29:51,210 set_state: layers/hidden_layer/layer_input/W_velocity <- array(100, 1024)
2017-10-18 11:29:51,213 set_state: layers/output_layer/input/W_velocity <- array(256, 10001)
2017-10-18 11:29:51,214 set_state: layers/projection_layer/W_velocity <- array(10001, 100)
2017-10-18 11:29:51,215 set_state: layers/hidden_layer/layer_input/b_velocity <- array(1024,)
2017-10-18 11:29:51,215 set_state: layers/hidden_layer/step_input/W_velocity <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 1.0 to 0.5 and resetting state to 100 % of epoch 6.
2017-10-18 11:29:51,216 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.1 minutes. Best validation perplexity 150.74.
2017-10-18 11:30:10,042 _log_update: [154] (8.7 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:30:34,533 _log_update: [354] (19.9 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:30:59,033 _log_update: [554] (31.2 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:31:23,530 _log_update: [754] (42.4 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:31:48,020 _log_update: [954] (53.7 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:32:12,508 _log_update: [1154] (64.9 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:32:36,994 _log_update: [1354] (76.2 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:33:01,484 _log_update: [1554] (87.4 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:33:25,975 _log_update: [1754] (98.7 %) of epoch 7 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:33:31,867 _validate: [1772] First validation sample, perplexity 144.81.
2017-10-18 11:33:43,186 _validate: [1775] Center of validation, perplexity 144.33.
2017-10-18 11:33:54,527 _validate: [1778] Last validation sample, perplexity 144.50.
2017-10-18 11:33:54,544 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:33:54,544 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 150.7 [144.4]
2017-10-18 11:33:54,544 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.1 minutes. Best validation perplexity 144.41.
2017-10-18 11:34:16,056 _log_update: [176] (9.9 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:34:40,543 _log_update: [376] (21.1 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:35:05,030 _log_update: [576] (32.4 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:35:29,511 _log_update: [776] (43.6 %) of epoch 8 -- lr = 0.5, duration = 12.2 ms
2017-10-18 11:35:54,002 _log_update: [976] (54.9 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:36:18,493 _log_update: [1176] (66.1 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:36:42,978 _log_update: [1376] (77.4 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:37:07,464 _log_update: [1576] (88.6 %) of epoch 8 -- lr = 0.5, duration = 12.1 ms
2017-10-18 11:37:35,138 _validate: [1772] First validation sample, perplexity 146.54.
2017-10-18 11:37:46,449 _validate: [1775] Center of validation, perplexity 146.44.
2017-10-18 11:37:46,565 _log_update: [1776] (99.9 %) of epoch 8 -- lr = 0.5, duration = 8.8 ms
2017-10-18 11:37:57,775 _validate: [1778] Last validation sample, perplexity 146.45.
2017-10-18 11:37:57,775 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 150.7 [144.4] 146.5
2017-10-18 11:37:57,777 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 11:37:57,777 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 11:37:57,778 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 11:37:57,778 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 11:37:57,779 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 11:37:57,782 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-18 11:37:57,783 _reset_state: [1775] (99.83 %) of epoch 7
2017-10-18 11:37:57,783 _log_validation: [1775] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 150.7 [144.4]
2017-10-18 11:37:57,784 set_state: Restored iterator to line 42002 of 42068.
2017-10-18 11:37:57,784 set_state: layers/output_layer/input/b_velocity <- array(10001,)
2017-10-18 11:37:57,785 set_state: layers/hidden_layer/layer_input/W_velocity <- array(100, 1024)
2017-10-18 11:37:57,788 set_state: layers/output_layer/input/W_velocity <- array(256, 10001)
2017-10-18 11:37:57,789 set_state: layers/projection_layer/W_velocity <- array(10001, 100)
2017-10-18 11:37:57,790 set_state: layers/hidden_layer/layer_input/b_velocity <- array(1024,)
2017-10-18 11:37:57,790 set_state: layers/hidden_layer/step_input/W_velocity <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.5 to 0.25 and resetting state to 100 % of epoch 7.
2017-10-18 11:37:57,791 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.1 minutes. Best validation perplexity 144.41.
2017-10-18 11:38:22,010 _log_update: [198] (11.1 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:38:46,489 _log_update: [398] (22.4 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:39:10,980 _log_update: [598] (33.6 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:39:35,467 _log_update: [798] (44.9 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:39:59,953 _log_update: [998] (56.1 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:40:24,444 _log_update: [1198] (67.4 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:40:48,927 _log_update: [1398] (78.6 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:41:13,433 _log_update: [1598] (89.9 %) of epoch 8 -- lr = 0.2, duration = 12.1 ms
2017-10-18 11:41:38,415 _validate: [1772] First validation sample, perplexity 145.24.
2017-10-18 11:41:49,726 _validate: [1775] Center of validation, perplexity 145.36.
2017-10-18 11:42:01,058 _validate: [1778] Last validation sample, perplexity 145.32.
2017-10-18 11:42:01,059 _log_validation: [1778] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 150.7 [144.4] 145.3
2017-10-18 11:42:01,060 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 11:42:01,061 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 11:42:01,061 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 11:42:01,062 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 11:42:01,062 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 11:42:01,065 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-18 11:42:01,067 _reset_state: [1775] (99.83 %) of epoch 7
2017-10-18 11:42:01,067 _log_validation: [1775] Validation set cost history: 289.0 202.4 172.1 162.5 152.1 150.7 [144.4]
2017-10-18 11:42:01,067 set_state: Restored iterator to line 42002 of 42068.
2017-10-18 11:42:01,068 set_state: layers/output_layer/input/b_velocity <- array(10001,)
2017-10-18 11:42:01,068 set_state: layers/hidden_layer/layer_input/W_velocity <- array(100, 1024)
2017-10-18 11:42:01,071 set_state: layers/output_layer/input/W_velocity <- array(256, 10001)
2017-10-18 11:42:01,073 set_state: layers/projection_layer/W_velocity <- array(10001, 100)
2017-10-18 11:42:01,073 set_state: layers/hidden_layer/layer_input/b_velocity <- array(1024,)
2017-10-18 11:42:01,074 set_state: layers/hidden_layer/step_input/W_velocity <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.25 to 0.125 and resetting state to 100 % of epoch 7.
Finished training epoch 7 in 0 hours 4.1 minutes. Best validation perplexity 144.41.
Training finished in 0 hours 40.6 minutes.
2017-10-18 11:42:01,076 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 11:42:01,076 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 11:42:01,077 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 11:42:01,077 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 11:42:01,077 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 11:42:01,081 set_state: layers/output_layer/input/W <- array(256, 10001)
Best validation set perplexity: 144.325247215
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.806954105815512
Perplexity: 122.35835873916209
