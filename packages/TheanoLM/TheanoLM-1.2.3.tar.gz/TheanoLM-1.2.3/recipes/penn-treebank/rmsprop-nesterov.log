/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0,optimizer_excluding=local_gpua_multinomial_wor
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-10-18 11:46:01,939 train: TRAINING OPTIONS
2017-10-18 11:46:01,939 train: patience: 0
2017-10-18 11:46:01,939 train: sequence_length: 25
2017-10-18 11:46:01,939 train: validation_frequency: 1
2017-10-18 11:46:01,939 train: stopping_criterion: no-improvement
2017-10-18 11:46:01,939 train: max_epochs: 15
2017-10-18 11:46:01,939 train: min_epochs: 1
2017-10-18 11:46:01,939 train: max_annealing_count: 0
2017-10-18 11:46:01,939 train: batch_size: 32
2017-10-18 11:46:01,939 train: OPTIMIZATION OPTIONS
2017-10-18 11:46:01,939 train: epsilon: 1e-06
2017-10-18 11:46:01,939 train: momentum: 0.9
2017-10-18 11:46:01,940 train: learning_rate: 1.0
2017-10-18 11:46:01,940 train: gradient_decay_rate: 0.9
2017-10-18 11:46:01,940 train: num_noise_samples: 1
2017-10-18 11:46:01,940 train: noise_sharing: None
2017-10-18 11:46:01,940 train: max_gradient_norm: 5.0
2017-10-18 11:46:01,940 train: weights: [ 1.]
2017-10-18 11:46:01,940 train: method: rmsprop-nesterov
2017-10-18 11:46:01,940 train: sqr_gradient_decay_rate: 0.999
Creating trainer.
Computing the number of mini-batches in training data.
2017-10-18 11:46:03,520 __init__: One epoch of training data contains 1778 mini-batch updates.
2017-10-18 11:46:03,521 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-10-18 11:46:03,521 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-10-18 11:46:03,544 _reset: Generating a random order of input lines.
Building neural network.
2017-10-18 11:46:03,569 __init__: Creating layers.
2017-10-18 11:46:03,569 __init__: - NetworkInput name=word_input inputs=[] size=10001 activation=tanh devices=[]
2017-10-18 11:46:03,569 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 activation=tanh devices=[None]
2017-10-18 11:46:03,649 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-10-18 11:46:03,649 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 activation=tanh devices=[None]
2017-10-18 11:46:03,657 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-10-18 11:46:03,782 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-10-18 11:46:03,782 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-10-18 11:46:03,782 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 activation=tanh devices=[None]
2017-10-18 11:46:03,994 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-10-18 11:46:03,994 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-10-18 11:46:03,994 __init__: Total number of model parameters: 3935925
Building optimizer.
2017-10-18 11:46:06,559 add:      * layers/output_layer/input/b_mean_sqr_gradient size=10001 type=float32 device=None
2017-10-18 11:46:06,559 add:      * layers/output_layer/input/b_velocity size=10001 type=float32 device=None
2017-10-18 11:46:06,564 add:      * layers/output_layer/input/W_mean_sqr_gradient size=2560256 type=float32 device=None
2017-10-18 11:46:06,569 add:      * layers/output_layer/input/W_velocity size=2560256 type=float32 device=None
2017-10-18 11:46:06,569 add:      * layers/hidden_layer/layer_input/b_mean_sqr_gradient size=1024 type=float32 device=None
2017-10-18 11:46:06,570 add:      * layers/hidden_layer/layer_input/b_velocity size=1024 type=float32 device=None
2017-10-18 11:46:06,570 add:      * layers/hidden_layer/layer_input/W_mean_sqr_gradient size=102400 type=float32 device=None
2017-10-18 11:46:06,570 add:      * layers/hidden_layer/layer_input/W_velocity size=102400 type=float32 device=None
2017-10-18 11:46:06,571 add:      * layers/hidden_layer/step_input/W_mean_sqr_gradient size=262144 type=float32 device=None
2017-10-18 11:46:06,572 add:      * layers/hidden_layer/step_input/W_velocity size=262144 type=float32 device=None
2017-10-18 11:46:06,575 add:      * layers/projection_layer/W_mean_sqr_gradient size=1000100 type=float32 device=None
2017-10-18 11:46:06,577 add:      * layers/projection_layer/W_velocity size=1000100 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-10-18 11:46:58,619 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:47:23,451 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:47:48,281 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:48:13,122 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:48:37,958 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:49:02,798 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:49:27,648 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:49:52,484 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1, duration = 12.3 ms
2017-10-18 11:50:17,537 _validate: [1772] First validation sample, perplexity 286.58.
2017-10-18 11:50:28,849 _validate: [1775] Center of validation, perplexity 285.07.
2017-10-18 11:50:40,250 _validate: [1778] Last validation sample, perplexity 284.13.
2017-10-18 11:50:40,292 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:50:40,292 _log_validation: [1778] Validation set cost history: [285.0]
2017-10-18 11:50:40,294 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 4.1 minutes. Best validation perplexity 284.99.
2017-10-18 11:50:42,993 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:51:07,858 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:51:32,704 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:51:57,548 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:52:22,405 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:52:47,250 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:53:12,099 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:53:36,943 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:54:01,792 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1, duration = 12.3 ms
2017-10-18 11:54:24,109 _validate: [1772] First validation sample, perplexity 200.74.
2017-10-18 11:54:35,422 _validate: [1775] Center of validation, perplexity 200.91.
2017-10-18 11:54:46,763 _validate: [1778] Last validation sample, perplexity 201.62.
2017-10-18 11:54:46,787 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:54:46,787 _log_validation: [1778] Validation set cost history: 285.0 [201.1]
2017-10-18 11:54:46,789 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 4.1 minutes. Best validation perplexity 201.06.
2017-10-18 11:54:52,222 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:55:17,069 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:55:41,907 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:56:06,771 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:56:31,618 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:56:56,465 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:57:21,321 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:57:46,166 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:58:11,023 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1, duration = 12.3 ms
2017-10-18 11:58:30,613 _validate: [1772] First validation sample, perplexity 170.31.
2017-10-18 11:58:41,924 _validate: [1775] Center of validation, perplexity 171.30.
2017-10-18 11:58:53,265 _validate: [1778] Last validation sample, perplexity 170.35.
2017-10-18 11:58:53,287 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 11:58:53,287 _log_validation: [1778] Validation set cost history: 285.0 201.1 [170.7]
2017-10-18 11:58:53,289 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 4.1 minutes. Best validation perplexity 170.65.
2017-10-18 11:59:01,459 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 11:59:26,310 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 11:59:51,165 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:00:16,028 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:00:40,891 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:01:05,767 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:01:30,625 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:01:55,483 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:02:20,348 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1, duration = 12.3 ms
2017-10-18 12:02:37,200 _validate: [1772] First validation sample, perplexity 160.61.
2017-10-18 12:02:48,517 _validate: [1775] Center of validation, perplexity 160.76.
2017-10-18 12:02:59,858 _validate: [1778] Last validation sample, perplexity 159.09.
2017-10-18 12:02:59,880 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 12:02:59,880 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 [160.6]
2017-10-18 12:02:59,882 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 4.1 minutes. Best validation perplexity 160.61.
2017-10-18 12:03:10,791 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:03:35,876 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1, duration = 12.4 ms
2017-10-18 12:04:00,828 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:04:25,694 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:04:50,558 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:05:15,427 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:05:40,324 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:06:05,199 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:06:30,069 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1, duration = 12.3 ms
2017-10-18 12:06:44,193 _validate: [1772] First validation sample, perplexity 151.53.
2017-10-18 12:06:55,494 _validate: [1775] Center of validation, perplexity 151.27.
2017-10-18 12:07:06,835 _validate: [1778] Last validation sample, perplexity 149.94.
2017-10-18 12:07:06,857 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 12:07:06,857 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 160.6 [151.3]
2017-10-18 12:07:06,859 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 4.1 minutes. Best validation perplexity 151.27.
2017-10-18 12:07:20,502 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:07:45,364 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:08:10,229 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:08:35,086 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:08:59,946 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:09:24,813 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:09:49,722 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:10:14,597 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1, duration = 12.7 ms
2017-10-18 12:10:39,458 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1, duration = 12.3 ms
2017-10-18 12:10:50,846 _validate: [1772] First validation sample, perplexity 149.27.
2017-10-18 12:11:02,162 _validate: [1775] Center of validation, perplexity 149.03.
2017-10-18 12:11:13,499 _validate: [1778] Last validation sample, perplexity 150.03.
2017-10-18 12:11:13,521 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 12:11:13,521 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 [149.3]
2017-10-18 12:11:13,523 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.1 minutes. Best validation perplexity 149.26.
2017-10-18 12:11:29,896 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:11:54,759 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:12:19,629 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:12:44,489 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:13:09,355 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:13:34,219 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:13:59,081 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:14:23,948 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:14:48,810 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1, duration = 12.3 ms
2017-10-18 12:14:57,462 _validate: [1772] First validation sample, perplexity 150.35.
2017-10-18 12:15:08,771 _validate: [1775] Center of validation, perplexity 151.34.
2017-10-18 12:15:20,102 _validate: [1778] Last validation sample, perplexity 150.42.
2017-10-18 12:15:20,102 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 [149.3] 151.3
2017-10-18 12:15:20,104 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 12:15:20,105 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 12:15:20,105 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 12:15:20,106 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 12:15:20,106 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 12:15:20,110 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-18 12:15:20,111 _reset_state: [1775] (99.83 %) of epoch 6
2017-10-18 12:15:20,112 _log_validation: [1775] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 [149.3]
2017-10-18 12:15:20,112 set_state: Restored iterator to line 41995 of 42068.
2017-10-18 12:15:20,113 set_state: layers/projection_layer/W_velocity <- array(10001, 100)
2017-10-18 12:15:20,114 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
2017-10-18 12:15:20,117 set_state: layers/output_layer/input/W_velocity <- array(256, 10001)
2017-10-18 12:15:20,118 set_state: layers/hidden_layer/step_input/W_velocity <- array(256, 1024)
2017-10-18 12:15:20,118 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-18 12:15:20,120 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-18 12:15:20,120 set_state: layers/hidden_layer/layer_input/b_velocity <- array(1024,)
2017-10-18 12:15:20,123 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-18 12:15:20,124 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-18 12:15:20,124 set_state: layers/hidden_layer/layer_input/W_velocity <- array(100, 1024)
2017-10-18 12:15:20,125 set_state: layers/output_layer/input/b_velocity <- array(10001,)
2017-10-18 12:15:20,125 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 1.0 to 0.5 and resetting state to 100 % of epoch 6.
2017-10-18 12:15:20,127 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.1 minutes. Best validation perplexity 149.26.
2017-10-18 12:15:39,235 _log_update: [154] (8.7 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:16:04,126 _log_update: [354] (19.9 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:16:28,984 _log_update: [554] (31.2 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:16:53,846 _log_update: [754] (42.4 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:17:18,714 _log_update: [954] (53.7 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:17:43,578 _log_update: [1154] (64.9 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:18:08,444 _log_update: [1354] (76.2 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:18:33,302 _log_update: [1554] (87.4 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:18:58,159 _log_update: [1754] (98.7 %) of epoch 7 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:19:04,080 _validate: [1772] First validation sample, perplexity 144.44.
2017-10-18 12:19:15,379 _validate: [1775] Center of validation, perplexity 144.12.
2017-10-18 12:19:26,709 _validate: [1778] Last validation sample, perplexity 144.32.
2017-10-18 12:19:26,731 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-10-18 12:19:26,731 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 149.3 [144.2]
2017-10-18 12:19:26,733 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.1 minutes. Best validation perplexity 144.24.
2017-10-18 12:19:48,573 _log_update: [176] (9.9 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:20:13,436 _log_update: [376] (21.1 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:20:38,297 _log_update: [576] (32.4 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:21:03,168 _log_update: [776] (43.6 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:21:28,033 _log_update: [976] (54.9 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:21:52,897 _log_update: [1176] (66.1 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:22:17,765 _log_update: [1376] (77.4 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:22:42,624 _log_update: [1576] (88.6 %) of epoch 8 -- lr = 0.5, duration = 12.3 ms
2017-10-18 12:23:10,671 _validate: [1772] First validation sample, perplexity 146.37.
2017-10-18 12:23:21,970 _validate: [1775] Center of validation, perplexity 146.18.
2017-10-18 12:23:22,100 _log_update: [1776] (99.9 %) of epoch 8 -- lr = 0.5, duration = 8.8 ms
2017-10-18 12:23:33,301 _validate: [1778] Last validation sample, perplexity 146.34.
2017-10-18 12:23:33,301 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 149.3 [144.2] 146.3
2017-10-18 12:23:33,303 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 12:23:33,303 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 12:23:33,304 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 12:23:33,305 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 12:23:33,305 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 12:23:33,309 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-18 12:23:33,310 _reset_state: [1775] (99.83 %) of epoch 7
2017-10-18 12:23:33,310 _log_validation: [1775] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 149.3 [144.2]
2017-10-18 12:23:33,311 set_state: Restored iterator to line 42002 of 42068.
2017-10-18 12:23:33,312 set_state: layers/projection_layer/W_velocity <- array(10001, 100)
2017-10-18 12:23:33,313 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
2017-10-18 12:23:33,316 set_state: layers/output_layer/input/W_velocity <- array(256, 10001)
2017-10-18 12:23:33,317 set_state: layers/hidden_layer/step_input/W_velocity <- array(256, 1024)
2017-10-18 12:23:33,317 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-18 12:23:33,318 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-18 12:23:33,319 set_state: layers/hidden_layer/layer_input/b_velocity <- array(1024,)
2017-10-18 12:23:33,322 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-18 12:23:33,323 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-18 12:23:33,323 set_state: layers/hidden_layer/layer_input/W_velocity <- array(100, 1024)
2017-10-18 12:23:33,323 set_state: layers/output_layer/input/b_velocity <- array(10001,)
2017-10-18 12:23:33,324 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 0.5 to 0.25 and resetting state to 100 % of epoch 7.
2017-10-18 12:23:33,325 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.1 minutes. Best validation perplexity 144.24.
2017-10-18 12:23:57,906 _log_update: [198] (11.1 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:24:22,774 _log_update: [398] (22.4 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:24:47,638 _log_update: [598] (33.6 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:25:12,508 _log_update: [798] (44.9 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:25:37,371 _log_update: [998] (56.1 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:26:02,244 _log_update: [1198] (67.4 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:26:27,107 _log_update: [1398] (78.6 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:26:51,968 _log_update: [1598] (89.9 %) of epoch 8 -- lr = 0.2, duration = 12.3 ms
2017-10-18 12:27:17,283 _validate: [1772] First validation sample, perplexity 143.97.
2017-10-18 12:27:28,580 _validate: [1775] Center of validation, perplexity 144.24.
2017-10-18 12:27:39,908 _validate: [1778] Last validation sample, perplexity 144.45.
2017-10-18 12:27:39,909 _log_validation: [1778] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 149.3 [144.2] 144.2
2017-10-18 12:27:39,911 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 12:27:39,911 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 12:27:39,912 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 12:27:39,912 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 12:27:39,913 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 12:27:39,916 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-10-18 12:27:39,918 _reset_state: [1775] (99.83 %) of epoch 7
2017-10-18 12:27:39,918 _log_validation: [1775] Validation set cost history: 285.0 201.1 170.7 160.6 151.3 149.3 [144.2]
2017-10-18 12:27:39,919 set_state: Restored iterator to line 42002 of 42068.
2017-10-18 12:27:39,920 set_state: layers/projection_layer/W_velocity <- array(10001, 100)
2017-10-18 12:27:39,921 set_state: layers/hidden_layer/step_input/W_mean_sqr_gradient <- array(256, 1024)
2017-10-18 12:27:39,924 set_state: layers/output_layer/input/W_velocity <- array(256, 10001)
2017-10-18 12:27:39,925 set_state: layers/hidden_layer/step_input/W_velocity <- array(256, 1024)
2017-10-18 12:27:39,925 set_state: layers/hidden_layer/layer_input/W_mean_sqr_gradient <- array(100, 1024)
2017-10-18 12:27:39,926 set_state: layers/projection_layer/W_mean_sqr_gradient <- array(10001, 100)
2017-10-18 12:27:39,927 set_state: layers/hidden_layer/layer_input/b_velocity <- array(1024,)
2017-10-18 12:27:39,930 set_state: layers/output_layer/input/W_mean_sqr_gradient <- array(256, 10001)
2017-10-18 12:27:39,930 set_state: layers/hidden_layer/layer_input/b_mean_sqr_gradient <- array(1024,)
2017-10-18 12:27:39,931 set_state: layers/hidden_layer/layer_input/W_velocity <- array(100, 1024)
2017-10-18 12:27:39,931 set_state: layers/output_layer/input/b_velocity <- array(10001,)
2017-10-18 12:27:39,932 set_state: layers/output_layer/input/b_mean_sqr_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 0.25 to 0.125 and resetting state to 100 % of epoch 7.
Finished training epoch 7 in 0 hours 4.1 minutes. Best validation perplexity 144.24.
Training finished in 0 hours 41.1 minutes.
2017-10-18 12:27:39,934 set_state: layers/projection_layer/W <- array(10001, 100)
2017-10-18 12:27:39,935 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-10-18 12:27:39,936 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-10-18 12:27:39,936 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-10-18 12:27:39,936 set_state: layers/output_layer/input/b <- array(10001,)
2017-10-18 12:27:39,939 set_state: layers/output_layer/input/W <- array(256, 10001)
Best validation set perplexity: 144.11853836
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.798907797158642
Perplexity: 121.37777594440426
