/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0,optimizer_excluding=local_gpua_multinomial_wor
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-09-13 16:35:46,661 train: TRAINING OPTIONS
2017-09-13 16:35:46,661 train: min_epochs: 1
2017-09-13 16:35:46,661 train: stopping_criterion: no-improvement
2017-09-13 16:35:46,661 train: validation_frequency: 1
2017-09-13 16:35:46,661 train: patience: 0
2017-09-13 16:35:46,661 train: max_epochs: 15
2017-09-13 16:35:46,661 train: sequence_length: 25
2017-09-13 16:35:46,662 train: max_annealing_count: 0
2017-09-13 16:35:46,662 train: batch_size: 24
2017-09-13 16:35:46,662 train: OPTIMIZATION OPTIONS
2017-09-13 16:35:46,662 train: max_gradient_norm: 5.0
2017-09-13 16:35:46,662 train: learning_rate: 20.0
2017-09-13 16:35:46,662 train: gradient_decay_rate: 0.9
2017-09-13 16:35:46,662 train: sqr_gradient_decay_rate: 0.999
2017-09-13 16:35:46,662 train: momentum: 0.9
2017-09-13 16:35:46,662 train: noise_sharing: None
2017-09-13 16:35:46,662 train: epsilon: 1e-06
2017-09-13 16:35:46,662 train: method: sgd
2017-09-13 16:35:46,662 train: weights: [ 1.]
2017-09-13 16:35:46,662 train: num_noise_samples: 25
Creating trainer.
Computing the number of mini-batches in training data.
2017-09-13 16:35:48,149 __init__: One epoch of training data contains 2371 mini-batch updates.
2017-09-13 16:35:48,150 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-09-13 16:35:48,150 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-09-13 16:35:48,174 _reset: Generating a random order of input lines.
Building neural network.
2017-09-13 16:35:48,184 __init__: Creating layers.
2017-09-13 16:35:48,185 __init__: - NetworkInput name=word_input inputs=[] size=10001 depth=1 devices=[]
2017-09-13 16:35:48,185 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 depth=1 devices=[None]
2017-09-13 16:35:48,263 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-09-13 16:35:48,263 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 depth=1 devices=[None]
2017-09-13 16:35:48,271 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-09-13 16:35:48,603 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-09-13 16:35:48,604 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-09-13 16:35:48,604 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 depth=1 devices=[None]
2017-09-13 16:35:48,822 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-09-13 16:35:48,823 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-09-13 16:35:48,823 __init__: Total number of parameters: 3935925
Building optimizer.
2017-09-13 16:35:51,146 add:      * layers/hidden_layer/layer_input/b_gradient size=1024 type=float32 device=None
2017-09-13 16:35:51,147 add:      * layers/hidden_layer/layer_input/W_gradient size=102400 type=float32 device=None
2017-09-13 16:35:51,149 add:      * layers/projection_layer/W_gradient size=1000100 type=float32 device=None
2017-09-13 16:35:51,155 add:      * layers/output_layer/input/W_gradient size=2560256 type=float32 device=None
2017-09-13 16:35:51,156 add:      * layers/hidden_layer/step_input/W_gradient size=262144 type=float32 device=None
2017-09-13 16:35:51,156 add:      * layers/output_layer/input/b_gradient size=10001 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-09-13 16:37:12,124 _log_update: [200] (8.4 %) of epoch 1 -- lr = 2e+01, duration = 30.1 ms
2017-09-13 16:38:11,167 _log_update: [400] (16.9 %) of epoch 1 -- lr = 2e+01, duration = 28.8 ms
2017-09-13 16:39:09,254 _log_update: [600] (25.3 %) of epoch 1 -- lr = 2e+01, duration = 30.1 ms
2017-09-13 16:40:07,599 _log_update: [800] (33.7 %) of epoch 1 -- lr = 2e+01, duration = 28.4 ms
2017-09-13 16:41:06,129 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 2e+01, duration = 28.3 ms
2017-09-13 16:42:02,856 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 2e+01, duration = 28.3 ms
2017-09-13 16:42:59,573 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 2e+01, duration = 28.3 ms
2017-09-13 16:43:56,233 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 2e+01, duration = 28.3 ms
2017-09-13 16:44:53,175 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 2e+01, duration = 29.2 ms
2017-09-13 16:45:50,107 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 2e+01, duration = 28.3 ms
2017-09-13 16:46:46,808 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 2e+01, duration = 28.2 ms
2017-09-13 16:47:37,362 _validate: [2365] First validation sample, perplexity 284.37.
2017-09-13 16:47:49,698 _validate: [2368] Center of validation, perplexity 292.76.
2017-09-13 16:48:02,108 _validate: [2371] Last validation sample, perplexity 316.55.
2017-09-13 16:48:02,131 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 16:48:02,131 _log_validation: [2371] Validation set cost history: [305.2]
2017-09-13 16:48:02,132 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 11.8 minutes. Best validation perplexity 305.15.
2017-09-13 16:48:10,270 _log_update: [29] (1.2 %) of epoch 2 -- lr = 2e+01, duration = 28.1 ms
2017-09-13 16:49:06,417 _log_update: [229] (9.7 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:50:02,559 _log_update: [429] (18.1 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:50:58,718 _log_update: [629] (26.5 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:51:54,880 _log_update: [829] (35.0 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:52:51,014 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:53:47,137 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:54:43,304 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:55:39,441 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 2e+01, duration = 28.2 ms
2017-09-13 16:56:35,584 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:57:31,712 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:58:27,849 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 16:59:09,881 _validate: [2365] First validation sample, perplexity 228.02.
2017-09-13 16:59:22,195 _validate: [2368] Center of validation, perplexity 246.02.
2017-09-13 16:59:34,443 _validate: [2371] Last validation sample, perplexity 246.60.
2017-09-13 16:59:34,460 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 16:59:34,460 _log_validation: [2371] Validation set cost history: 305.2 [236.9]
2017-09-13 16:59:34,460 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 11.5 minutes. Best validation perplexity 236.86.
2017-09-13 16:59:50,733 _log_update: [58] (2.4 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:00:46,855 _log_update: [258] (10.9 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:01:43,035 _log_update: [458] (19.3 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:02:39,182 _log_update: [658] (27.8 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:03:35,322 _log_update: [858] (36.2 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:04:31,447 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 2e+01, duration = 27.9 ms
2017-09-13 17:05:27,590 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 2e+01, duration = 27.9 ms
2017-09-13 17:06:23,747 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 2e+01, duration = 27.9 ms
2017-09-13 17:07:19,890 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:08:16,033 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:09:12,200 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:10:08,318 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:10:42,185 _validate: [2365] First validation sample, perplexity 220.17.
2017-09-13 17:10:54,502 _validate: [2368] Center of validation, perplexity 209.79.
2017-09-13 17:11:06,748 _validate: [2371] Last validation sample, perplexity 228.18.
2017-09-13 17:11:06,764 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 17:11:06,764 _log_validation: [2371] Validation set cost history: 305.2 236.9 [213.0]
2017-09-13 17:11:06,765 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 11.5 minutes. Best validation perplexity 213.04.
2017-09-13 17:11:31,174 _log_update: [87] (3.7 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:12:27,297 _log_update: [287] (12.1 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:13:23,433 _log_update: [487] (20.5 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:14:19,567 _log_update: [687] (29.0 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:15:15,700 _log_update: [887] (37.4 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:16:11,857 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:17:08,004 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:18:04,134 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:19:00,266 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:19:56,403 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:20:52,521 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:21:48,685 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:22:14,424 _validate: [2365] First validation sample, perplexity 234.49.
2017-09-13 17:22:26,732 _validate: [2368] Center of validation, perplexity 192.04.
2017-09-13 17:22:38,962 _validate: [2371] Last validation sample, perplexity 225.75.
2017-09-13 17:22:38,978 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 17:22:38,978 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 [198.1]
2017-09-13 17:22:38,979 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 11.5 minutes. Best validation perplexity 198.11.
2017-09-13 17:23:11,527 _log_update: [116] (4.9 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:24:07,711 _log_update: [316] (13.3 %) of epoch 5 -- lr = 2e+01, duration = 27.9 ms
2017-09-13 17:25:03,835 _log_update: [516] (21.8 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:25:59,965 _log_update: [716] (30.2 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:26:56,094 _log_update: [916] (38.6 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:27:52,217 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:28:48,334 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:29:44,461 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:30:40,599 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 2e+01, duration = 28.3 ms
2017-09-13 17:31:36,837 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:32:32,989 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:33:29,104 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:33:46,706 _validate: [2365] First validation sample, perplexity 181.87.
2017-09-13 17:33:59,017 _validate: [2368] Center of validation, perplexity 180.75.
2017-09-13 17:34:11,257 _validate: [2371] Last validation sample, perplexity 210.76.
2017-09-13 17:34:11,272 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 17:34:11,272 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 [181.9]
2017-09-13 17:34:11,273 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 11.5 minutes. Best validation perplexity 181.87.
2017-09-13 17:34:51,950 _log_update: [145] (6.1 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:35:48,080 _log_update: [345] (14.6 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:36:44,222 _log_update: [545] (23.0 %) of epoch 6 -- lr = 2e+01, duration = 27.9 ms
2017-09-13 17:37:40,354 _log_update: [745] (31.4 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:38:36,475 _log_update: [945] (39.9 %) of epoch 6 -- lr = 2e+01, duration = 27.9 ms
2017-09-13 17:39:32,594 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:40:28,726 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:41:24,881 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:42:20,994 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:43:17,121 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:44:13,265 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:45:09,860 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 2e+01, duration = 28.0 ms
2017-09-13 17:45:19,312 _validate: [2365] First validation sample, perplexity 188.79.
2017-09-13 17:45:31,622 _validate: [2368] Center of validation, perplexity 179.12.
2017-09-13 17:45:43,853 _validate: [2371] Last validation sample, perplexity 199.20.
2017-09-13 17:45:43,853 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 [181.9] 188.8
2017-09-13 17:45:43,855 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 17:45:43,855 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 17:45:43,856 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 17:45:43,856 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 17:45:43,857 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 17:45:43,860 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-09-13 17:45:43,861 _reset_state: [2368] (99.87 %) of epoch 5
2017-09-13 17:45:43,861 _log_validation: [2368] Validation set cost history: 305.2 236.9 213.0 198.1 [181.9]
2017-09-13 17:45:43,862 set_state: Restored iterator to line 42026 of 42068.
2017-09-13 17:45:43,863 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-09-13 17:45:43,864 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-09-13 17:45:43,864 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-09-13 17:45:43,872 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-09-13 17:45:43,872 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-09-13 17:45:43,873 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 5.
2017-09-13 17:45:43,874 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 11.5 minutes. Best validation perplexity 181.87.
2017-09-13 17:46:32,723 _log_update: [174] (7.3 %) of epoch 6 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:47:28,865 _log_update: [374] (15.8 %) of epoch 6 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 17:48:24,997 _log_update: [574] (24.2 %) of epoch 6 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:49:21,106 _log_update: [774] (32.6 %) of epoch 6 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:50:17,210 _log_update: [974] (41.1 %) of epoch 6 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 17:51:13,342 _log_update: [1174] (49.5 %) of epoch 6 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:52:09,430 _log_update: [1374] (58.0 %) of epoch 6 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:53:05,524 _log_update: [1574] (66.4 %) of epoch 6 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 17:54:01,617 _log_update: [1774] (74.8 %) of epoch 6 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:54:57,708 _log_update: [1974] (83.3 %) of epoch 6 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 17:55:53,812 _log_update: [2174] (91.7 %) of epoch 6 -- lr = 1e+01, duration = 28.9 ms
2017-09-13 17:56:51,223 _validate: [2365] First validation sample, perplexity 171.06.
2017-09-13 17:57:03,542 _validate: [2368] Center of validation, perplexity 168.51.
2017-09-13 17:57:15,769 _validate: [2371] Last validation sample, perplexity 169.87.
2017-09-13 17:57:15,785 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 17:57:15,785 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 [169.9]
2017-09-13 17:57:15,786 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 11.5 minutes. Best validation perplexity 169.87.
2017-09-13 17:57:16,620 _log_update: [3] (0.1 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:58:12,723 _log_update: [203] (8.6 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 17:59:08,814 _log_update: [403] (17.0 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:00:04,910 _log_update: [603] (25.4 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:01:01,034 _log_update: [803] (33.9 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:01:57,162 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:02:53,352 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:03:49,485 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:04:45,637 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:05:41,767 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:06:37,908 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:07:34,041 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:08:23,352 _validate: [2365] First validation sample, perplexity 168.07.
2017-09-13 18:08:35,659 _validate: [2368] Center of validation, perplexity 165.80.
2017-09-13 18:08:47,887 _validate: [2371] Last validation sample, perplexity 170.13.
2017-09-13 18:08:47,903 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 18:08:47,903 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 [168.7]
2017-09-13 18:08:47,904 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 11.5 minutes. Best validation perplexity 168.72.
2017-09-13 18:08:56,874 _log_update: [32] (1.3 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:09:53,003 _log_update: [232] (9.8 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:10:49,136 _log_update: [432] (18.2 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:11:45,297 _log_update: [632] (26.7 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:12:41,433 _log_update: [832] (35.1 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:13:37,572 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:14:33,696 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:15:29,830 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:16:25,976 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:17:22,106 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:18:18,245 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:19:14,383 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:19:55,559 _validate: [2365] First validation sample, perplexity 160.74.
2017-09-13 18:20:07,885 _validate: [2368] Center of validation, perplexity 164.86.
2017-09-13 18:20:20,124 _validate: [2371] Last validation sample, perplexity 170.76.
2017-09-13 18:20:20,139 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 18:20:20,139 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 [165.5]
2017-09-13 18:20:20,140 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 11.5 minutes. Best validation perplexity 165.49.
2017-09-13 18:20:37,250 _log_update: [61] (2.6 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:21:33,402 _log_update: [261] (11.0 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:22:29,535 _log_update: [461] (19.4 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:23:25,682 _log_update: [661] (27.9 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:24:21,900 _log_update: [861] (36.3 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:25:18,042 _log_update: [1061] (44.7 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:26:14,404 _log_update: [1261] (53.2 %) of epoch 9 -- lr = 1e+01, duration = 28.1 ms
2017-09-13 18:27:10,493 _log_update: [1461] (61.6 %) of epoch 9 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:28:06,581 _log_update: [1661] (70.1 %) of epoch 9 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:29:02,665 _log_update: [1861] (78.5 %) of epoch 9 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:29:58,747 _log_update: [2061] (86.9 %) of epoch 9 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:30:54,874 _log_update: [2261] (95.4 %) of epoch 9 -- lr = 1e+01, duration = 29.4 ms
2017-09-13 18:31:28,036 _validate: [2365] First validation sample, perplexity 161.42.
2017-09-13 18:31:40,350 _validate: [2368] Center of validation, perplexity 161.12.
2017-09-13 18:31:52,581 _validate: [2371] Last validation sample, perplexity 164.89.
2017-09-13 18:31:52,597 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 18:31:52,597 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 [164.5]
2017-09-13 18:31:52,598 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 11.5 minutes. Best validation perplexity 164.54.
2017-09-13 18:32:17,845 _log_update: [90] (3.8 %) of epoch 10 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:33:13,919 _log_update: [290] (12.2 %) of epoch 10 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:34:09,994 _log_update: [490] (20.7 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:35:06,084 _log_update: [690] (29.1 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:36:02,207 _log_update: [890] (37.5 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:36:58,324 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:37:54,433 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:38:50,554 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 1e+01, duration = 27.9 ms
2017-09-13 18:39:46,680 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:40:42,826 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:41:38,981 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:42:35,118 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 1e+01, duration = 28.0 ms
2017-09-13 18:43:00,027 _validate: [2365] First validation sample, perplexity 166.57.
2017-09-13 18:43:12,342 _validate: [2368] Center of validation, perplexity 164.46.
2017-09-13 18:43:24,602 _validate: [2371] Last validation sample, perplexity 162.35.
2017-09-13 18:43:24,602 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 [164.5] 165.3
2017-09-13 18:43:24,604 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 18:43:24,604 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 18:43:24,605 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 18:43:24,605 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 18:43:24,605 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 18:43:24,608 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-09-13 18:43:24,610 _reset_state: [2368] (99.87 %) of epoch 9
2017-09-13 18:43:24,610 _log_validation: [2368] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 [164.5]
2017-09-13 18:43:24,611 set_state: Restored iterator to line 42024 of 42068.
2017-09-13 18:43:24,612 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-09-13 18:43:24,612 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-09-13 18:43:24,613 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-09-13 18:43:24,621 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-09-13 18:43:24,621 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-09-13 18:43:24,622 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 9.
2017-09-13 18:43:24,622 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 11.5 minutes. Best validation perplexity 164.54.
2017-09-13 18:43:58,011 _log_update: [119] (5.0 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:44:54,596 _log_update: [319] (13.5 %) of epoch 10 -- lr = 5, duration = 29.5 ms
2017-09-13 18:45:50,776 _log_update: [519] (21.9 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:46:46,920 _log_update: [719] (30.3 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:47:43,057 _log_update: [919] (38.8 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:48:39,189 _log_update: [1119] (47.2 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:49:35,305 _log_update: [1319] (55.6 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:50:31,439 _log_update: [1519] (64.1 %) of epoch 10 -- lr = 5, duration = 27.9 ms
2017-09-13 18:51:27,586 _log_update: [1719] (72.5 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:52:23,721 _log_update: [1919] (80.9 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:53:19,838 _log_update: [2119] (89.4 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:54:15,961 _log_update: [2319] (97.8 %) of epoch 10 -- lr = 5, duration = 28.0 ms
2017-09-13 18:54:32,717 _validate: [2365] First validation sample, perplexity 160.20.
2017-09-13 18:54:45,031 _validate: [2368] Center of validation, perplexity 159.56.
2017-09-13 18:54:57,266 _validate: [2371] Last validation sample, perplexity 156.82.
2017-09-13 18:54:57,281 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 18:54:57,281 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 [158.3]
2017-09-13 18:54:57,282 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 11.5 minutes. Best validation perplexity 158.29.
2017-09-13 18:55:38,800 _log_update: [148] (6.2 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 18:56:34,935 _log_update: [348] (14.7 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 18:57:31,039 _log_update: [548] (23.1 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 18:58:27,140 _log_update: [748] (31.5 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 18:59:23,246 _log_update: [948] (40.0 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:00:19,359 _log_update: [1148] (48.4 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:01:15,503 _log_update: [1348] (56.9 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:02:11,639 _log_update: [1548] (65.3 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:03:07,759 _log_update: [1748] (73.7 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:04:03,867 _log_update: [1948] (82.2 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:04:59,976 _log_update: [2148] (90.6 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:05:56,116 _log_update: [2348] (99.0 %) of epoch 11 -- lr = 5, duration = 28.0 ms
2017-09-13 19:06:04,740 _validate: [2365] First validation sample, perplexity 158.01.
2017-09-13 19:06:17,056 _validate: [2368] Center of validation, perplexity 158.35.
2017-09-13 19:06:29,296 _validate: [2371] Last validation sample, perplexity 157.94.
2017-09-13 19:06:29,312 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 19:06:29,312 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 [158.0]
2017-09-13 19:06:29,313 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 11.5 minutes. Best validation perplexity 158.01.
2017-09-13 19:07:18,974 _log_update: [177] (7.5 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:08:15,089 _log_update: [377] (15.9 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:09:11,208 _log_update: [577] (24.3 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:10:07,316 _log_update: [777] (32.8 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:11:03,461 _log_update: [977] (41.2 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:11:59,570 _log_update: [1177] (49.6 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:12:55,682 _log_update: [1377] (58.1 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:13:51,794 _log_update: [1577] (66.5 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:14:47,919 _log_update: [1777] (74.9 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:15:44,050 _log_update: [1977] (83.4 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:16:40,198 _log_update: [2177] (91.8 %) of epoch 12 -- lr = 5, duration = 28.0 ms
2017-09-13 19:17:36,813 _validate: [2365] First validation sample, perplexity 159.60.
2017-09-13 19:17:49,125 _validate: [2368] Center of validation, perplexity 159.39.
2017-09-13 19:18:01,369 _validate: [2371] Last validation sample, perplexity 156.47.
2017-09-13 19:18:01,369 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 [158.0] 158.8
2017-09-13 19:18:01,371 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 19:18:01,371 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 19:18:01,372 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 19:18:01,372 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 19:18:01,373 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 19:18:01,376 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-09-13 19:18:01,377 _reset_state: [2368] (99.87 %) of epoch 11
2017-09-13 19:18:01,377 _log_validation: [2368] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 [158.0]
2017-09-13 19:18:01,378 set_state: Restored iterator to line 42026 of 42068.
2017-09-13 19:18:01,379 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-09-13 19:18:01,380 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-09-13 19:18:01,380 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-09-13 19:18:01,388 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-09-13 19:18:01,389 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-09-13 19:18:01,389 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 11.
2017-09-13 19:18:01,390 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 11.5 minutes. Best validation perplexity 158.01.
2017-09-13 19:18:03,065 _log_update: [6] (0.3 %) of epoch 12 -- lr = 2, duration = 27.9 ms
2017-09-13 19:18:59,178 _log_update: [206] (8.7 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:19:55,292 _log_update: [406] (17.1 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:20:51,424 _log_update: [606] (25.6 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:21:47,570 _log_update: [806] (34.0 %) of epoch 12 -- lr = 2, duration = 27.9 ms
2017-09-13 19:22:43,686 _log_update: [1006] (42.4 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:23:39,874 _log_update: [1206] (50.9 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:24:36,003 _log_update: [1406] (59.3 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:25:32,120 _log_update: [1606] (67.7 %) of epoch 12 -- lr = 2, duration = 27.9 ms
2017-09-13 19:26:28,279 _log_update: [1806] (76.2 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:27:24,421 _log_update: [2006] (84.6 %) of epoch 12 -- lr = 2, duration = 27.9 ms
2017-09-13 19:28:20,559 _log_update: [2206] (93.0 %) of epoch 12 -- lr = 2, duration = 28.0 ms
2017-09-13 19:29:09,043 _validate: [2365] First validation sample, perplexity 158.02.
2017-09-13 19:29:21,358 _validate: [2368] Center of validation, perplexity 155.71.
2017-09-13 19:29:33,606 _validate: [2371] Last validation sample, perplexity 156.31.
2017-09-13 19:29:33,621 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 19:29:33,621 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 [156.1]
2017-09-13 19:29:33,622 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 11.5 minutes. Best validation perplexity 156.08.
2017-09-13 19:29:43,435 _log_update: [35] (1.5 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:30:39,557 _log_update: [235] (9.9 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:31:35,713 _log_update: [435] (18.3 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:32:31,838 _log_update: [635] (26.8 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:33:27,949 _log_update: [835] (35.2 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:34:24,069 _log_update: [1035] (43.7 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:35:20,188 _log_update: [1235] (52.1 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:36:16,424 _log_update: [1435] (60.5 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:37:12,546 _log_update: [1635] (69.0 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:38:08,671 _log_update: [1835] (77.4 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:39:04,780 _log_update: [2035] (85.8 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:40:00,898 _log_update: [2235] (94.3 %) of epoch 13 -- lr = 2, duration = 28.0 ms
2017-09-13 19:40:41,218 _validate: [2365] First validation sample, perplexity 157.23.
2017-09-13 19:40:53,535 _validate: [2368] Center of validation, perplexity 156.37.
2017-09-13 19:41:05,804 _validate: [2371] Last validation sample, perplexity 156.85.
2017-09-13 19:41:05,804 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 [156.1] 156.5
2017-09-13 19:41:05,806 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 19:41:05,806 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 19:41:05,807 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 19:41:05,807 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 19:41:05,808 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 19:41:05,811 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-09-13 19:41:05,812 _reset_state: [2368] (99.87 %) of epoch 12
2017-09-13 19:41:05,812 _log_validation: [2368] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 [156.1]
2017-09-13 19:41:05,813 set_state: Restored iterator to line 42022 of 42068.
2017-09-13 19:41:05,814 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-09-13 19:41:05,814 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-09-13 19:41:05,815 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-09-13 19:41:05,823 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-09-13 19:41:05,823 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-09-13 19:41:05,824 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 12.
2017-09-13 19:41:05,825 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 11.5 minutes. Best validation perplexity 156.08.
2017-09-13 19:41:23,772 _log_update: [64] (2.7 %) of epoch 13 -- lr = 1, duration = 27.9 ms
2017-09-13 19:42:19,872 _log_update: [264] (11.1 %) of epoch 13 -- lr = 1, duration = 27.9 ms
2017-09-13 19:43:15,971 _log_update: [464] (19.6 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:44:12,069 _log_update: [664] (28.0 %) of epoch 13 -- lr = 1, duration = 27.9 ms
2017-09-13 19:45:08,614 _log_update: [864] (36.4 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:46:04,747 _log_update: [1064] (44.9 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:47:00,872 _log_update: [1264] (53.3 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:47:56,994 _log_update: [1464] (61.7 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:48:53,120 _log_update: [1664] (70.2 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:49:49,236 _log_update: [1864] (78.6 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:50:45,372 _log_update: [2064] (87.1 %) of epoch 13 -- lr = 1, duration = 27.9 ms
2017-09-13 19:51:41,491 _log_update: [2264] (95.5 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-09-13 19:52:13,665 _validate: [2365] First validation sample, perplexity 155.84.
2017-09-13 19:52:25,975 _validate: [2368] Center of validation, perplexity 155.74.
2017-09-13 19:52:38,213 _validate: [2371] Last validation sample, perplexity 155.97.
2017-09-13 19:52:38,228 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 19:52:38,228 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 156.1 [155.7]
2017-09-13 19:52:38,229 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 11.5 minutes. Best validation perplexity 155.74.
2017-09-13 19:53:04,316 _log_update: [93] (3.9 %) of epoch 14 -- lr = 1, duration = 27.9 ms
2017-09-13 19:54:00,437 _log_update: [293] (12.4 %) of epoch 14 -- lr = 1, duration = 27.9 ms
2017-09-13 19:54:56,538 _log_update: [493] (20.8 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 19:55:52,663 _log_update: [693] (29.2 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 19:56:48,798 _log_update: [893] (37.7 %) of epoch 14 -- lr = 1, duration = 27.9 ms
2017-09-13 19:57:44,929 _log_update: [1093] (46.1 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 19:58:41,050 _log_update: [1293] (54.5 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 19:59:37,177 _log_update: [1493] (63.0 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 20:00:33,299 _log_update: [1693] (71.4 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 20:01:29,464 _log_update: [1893] (79.8 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 20:02:25,594 _log_update: [2093] (88.3 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 20:03:21,758 _log_update: [2293] (96.7 %) of epoch 14 -- lr = 1, duration = 28.0 ms
2017-09-13 20:03:45,802 _validate: [2365] First validation sample, perplexity 154.86.
2017-09-13 20:03:58,109 _validate: [2368] Center of validation, perplexity 154.74.
2017-09-13 20:04:10,348 _validate: [2371] Last validation sample, perplexity 155.01.
2017-09-13 20:04:10,363 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-09-13 20:04:10,363 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 156.1 155.7 [154.9]
2017-09-13 20:04:10,364 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 11.5 minutes. Best validation perplexity 154.89.
2017-09-13 20:04:44,608 _log_update: [122] (5.1 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:05:40,743 _log_update: [322] (13.6 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:06:36,921 _log_update: [522] (22.0 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:07:33,069 _log_update: [722] (30.5 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:08:29,209 _log_update: [922] (38.9 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:09:25,355 _log_update: [1122] (47.3 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:10:21,492 _log_update: [1322] (55.8 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:11:17,655 _log_update: [1522] (64.2 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:12:13,784 _log_update: [1722] (72.6 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:13:09,925 _log_update: [1922] (81.1 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:14:06,053 _log_update: [2122] (89.5 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:15:02,178 _log_update: [2322] (97.9 %) of epoch 15 -- lr = 1, duration = 28.0 ms
2017-09-13 20:15:18,098 _validate: [2365] First validation sample, perplexity 155.43.
2017-09-13 20:15:30,408 _validate: [2368] Center of validation, perplexity 155.50.
2017-09-13 20:15:42,647 _validate: [2371] Last validation sample, perplexity 155.70.
2017-09-13 20:15:42,647 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 156.1 155.7 [154.9] 155.7
2017-09-13 20:15:42,649 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 20:15:42,649 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 20:15:42,650 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 20:15:42,650 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 20:15:42,650 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 20:15:42,653 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-09-13 20:15:42,655 _reset_state: [2368] (99.87 %) of epoch 14
2017-09-13 20:15:42,655 _log_validation: [2368] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 156.1 155.7 [154.9]
2017-09-13 20:15:42,656 set_state: Restored iterator to line 42022 of 42068.
2017-09-13 20:15:42,657 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-09-13 20:15:42,657 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-09-13 20:15:42,658 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-09-13 20:15:42,665 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-09-13 20:15:42,666 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-09-13 20:15:42,666 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 14.
2017-09-13 20:15:42,667 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 11.5 minutes. Best validation perplexity 154.89.
2017-09-13 20:16:25,076 _log_update: [151] (6.4 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:17:21,220 _log_update: [351] (14.8 %) of epoch 15 -- lr = 0.6, duration = 28.1 ms
2017-09-13 20:18:17,368 _log_update: [551] (23.2 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:19:13,509 _log_update: [751] (31.7 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:20:09,646 _log_update: [951] (40.1 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:21:05,814 _log_update: [1151] (48.5 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:22:01,942 _log_update: [1351] (57.0 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:22:58,083 _log_update: [1551] (65.4 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:23:54,292 _log_update: [1751] (73.9 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:24:50,372 _log_update: [1951] (82.3 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:25:46,461 _log_update: [2151] (90.7 %) of epoch 15 -- lr = 0.6, duration = 28.0 ms
2017-09-13 20:26:42,561 _log_update: [2351] (99.2 %) of epoch 15 -- lr = 0.6, duration = 27.9 ms
2017-09-13 20:26:50,336 _validate: [2365] First validation sample, perplexity 156.12.
2017-09-13 20:27:02,660 _validate: [2368] Center of validation, perplexity 155.79.
2017-09-13 20:27:14,895 _validate: [2371] Last validation sample, perplexity 155.62.
2017-09-13 20:27:14,895 _log_validation: [2371] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 156.1 155.7 [154.9] 155.7
2017-09-13 20:27:14,896 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 20:27:14,897 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 20:27:14,897 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 20:27:14,898 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 20:27:14,898 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 20:27:14,901 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-09-13 20:27:14,902 _reset_state: [2368] (99.87 %) of epoch 14
2017-09-13 20:27:14,903 _log_validation: [2368] Validation set cost history: 305.2 236.9 213.0 198.1 181.9 169.9 168.7 165.5 164.5 158.3 158.0 156.1 155.7 [154.9]
2017-09-13 20:27:14,903 set_state: Restored iterator to line 42022 of 42068.
2017-09-13 20:27:14,904 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-09-13 20:27:14,905 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-09-13 20:27:14,905 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-09-13 20:27:14,913 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-09-13 20:27:14,914 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-09-13 20:27:14,914 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 14.
Finished training epoch 14 in 0 hours 11.5 minutes. Best validation perplexity 154.89.
Training finished in 3 hours 51.0 minutes.
2017-09-13 20:27:14,917 set_state: layers/projection_layer/W <- array(10001, 100)
2017-09-13 20:27:14,917 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-09-13 20:27:14,917 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-09-13 20:27:14,918 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-09-13 20:27:14,918 set_state: layers/output_layer/input/b <- array(10001,)
2017-09-13 20:27:14,922 set_state: layers/output_layer/input/W <- array(256, 10001)
Best validation set perplexity: 154.73847567
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Scoring text.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.850498865566036
Perplexity: 127.80413102573294
