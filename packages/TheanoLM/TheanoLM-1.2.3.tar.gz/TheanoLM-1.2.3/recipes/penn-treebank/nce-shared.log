/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-08-03 10:24:14,496 train: TRAINING OPTIONS
2017-08-03 10:24:14,496 train: stopping_criterion: no-improvement
2017-08-03 10:24:14,496 train: batch_size: 24
2017-08-03 10:24:14,496 train: sequence_length: 25
2017-08-03 10:24:14,496 train: min_epochs: 1
2017-08-03 10:24:14,496 train: patience: 0
2017-08-03 10:24:14,497 train: max_epochs: 15
2017-08-03 10:24:14,497 train: validation_frequency: 1
2017-08-03 10:24:14,497 train: max_annealing_count: 0
2017-08-03 10:24:14,497 train: OPTIMIZATION OPTIONS
2017-08-03 10:24:14,497 train: method: sgd
2017-08-03 10:24:14,497 train: epsilon: 1e-06
2017-08-03 10:24:14,497 train: learning_rate: 5.0
2017-08-03 10:24:14,497 train: weights: [ 1.]
2017-08-03 10:24:14,497 train: num_noise_samples: 100
2017-08-03 10:24:14,497 train: noise_sharing: batch
2017-08-03 10:24:14,497 train: sqr_gradient_decay_rate: 0.999
2017-08-03 10:24:14,497 train: momentum: 0.9
2017-08-03 10:24:14,497 train: max_gradient_norm: 5.0
2017-08-03 10:24:14,497 train: gradient_decay_rate: 0.9
Creating trainer.
Computing the number of mini-batches in training data.
2017-08-03 10:24:15,806 __init__: One epoch of training data contains 2371 mini-batch updates.
2017-08-03 10:24:15,807 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-08-03 10:24:15,807 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-08-03 10:24:15,827 _reset: Generating a random order of input lines.
Building neural network.
2017-08-03 10:24:15,834 __init__: Creating layers.
2017-08-03 10:24:15,834 __init__: - NetworkInput name=word_input inputs=[] size=10001 depth=1 devices=[]
2017-08-03 10:24:15,834 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 depth=1 devices=[None]
2017-08-03 10:24:15,912 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-08-03 10:24:15,912 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 depth=1 devices=[None]
2017-08-03 10:24:15,921 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-08-03 10:24:16,193 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-08-03 10:24:16,194 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-08-03 10:24:16,194 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 depth=1 devices=[None]
2017-08-03 10:24:16,412 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-08-03 10:24:16,413 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-08-03 10:24:16,413 __init__: Total number of parameters: 3935925
Building optimizer.
2017-08-03 10:24:18,910 add:      * layers/projection_layer/W_gradient size=1000100 type=float32 device=None
2017-08-03 10:24:18,915 add:      * layers/output_layer/input/W_gradient size=2560256 type=float32 device=None
2017-08-03 10:24:18,915 add:      * layers/hidden_layer/layer_input/b_gradient size=1024 type=float32 device=None
2017-08-03 10:24:18,916 add:      * layers/hidden_layer/layer_input/W_gradient size=102400 type=float32 device=None
2017-08-03 10:24:18,916 add:      * layers/hidden_layer/step_input/W_gradient size=262144 type=float32 device=None
2017-08-03 10:24:18,917 add:      * layers/output_layer/input/b_gradient size=10001 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-08-03 10:26:35,352 _log_update: [200] (8.4 %) of epoch 1 -- lr = 5, duration = 25.8 ms
2017-08-03 10:27:28,113 _log_update: [400] (16.9 %) of epoch 1 -- lr = 5, duration = 27.3 ms
2017-08-03 10:28:20,947 _log_update: [600] (25.3 %) of epoch 1 -- lr = 5, duration = 26.5 ms
2017-08-03 10:29:13,791 _log_update: [800] (33.7 %) of epoch 1 -- lr = 5, duration = 25.8 ms
2017-08-03 10:30:06,776 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 5, duration = 26.0 ms
2017-08-03 10:30:59,589 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 5, duration = 27.6 ms
2017-08-03 10:31:52,440 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 5, duration = 26.5 ms
2017-08-03 10:32:44,942 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 5, duration = 26.9 ms
2017-08-03 10:33:37,924 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 5, duration = 26.0 ms
2017-08-03 10:34:30,637 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 5, duration = 27.3 ms
2017-08-03 10:35:23,521 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 5, duration = 26.3 ms
2017-08-03 10:36:10,962 _validate: [2365] First validation sample, perplexity 421.66.
2017-08-03 10:36:23,285 _validate: [2368] Center of validation, perplexity 399.96.
2017-08-03 10:36:35,659 _validate: [2371] Last validation sample, perplexity 411.80.
2017-08-03 10:36:35,680 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 10:36:35,680 _log_validation: [2371] Validation set cost history: [409.6]
2017-08-03 10:36:35,681 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 10.9 minutes. Best validation perplexity 409.61.
2017-08-03 10:36:43,313 _log_update: [29] (1.2 %) of epoch 2 -- lr = 5, duration = 26.1 ms
2017-08-03 10:37:36,457 _log_update: [229] (9.7 %) of epoch 2 -- lr = 5, duration = 27.3 ms
2017-08-03 10:38:29,354 _log_update: [429] (18.1 %) of epoch 2 -- lr = 5, duration = 23.5 ms
2017-08-03 10:39:22,344 _log_update: [629] (26.5 %) of epoch 2 -- lr = 5, duration = 27.9 ms
2017-08-03 10:40:15,134 _log_update: [829] (35.0 %) of epoch 2 -- lr = 5, duration = 25.0 ms
2017-08-03 10:41:08,098 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 5, duration = 27.3 ms
2017-08-03 10:42:00,745 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 5, duration = 27.1 ms
2017-08-03 10:42:53,350 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 5, duration = 26.9 ms
2017-08-03 10:43:46,066 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 5, duration = 26.7 ms
2017-08-03 10:44:38,948 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 5, duration = 24.5 ms
2017-08-03 10:45:31,611 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 5, duration = 24.8 ms
2017-08-03 10:46:24,428 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 5, duration = 27.1 ms
2017-08-03 10:47:04,214 _validate: [2365] First validation sample, perplexity 280.01.
2017-08-03 10:47:16,521 _validate: [2368] Center of validation, perplexity 278.54.
2017-08-03 10:47:28,861 _validate: [2371] Last validation sample, perplexity 349.27.
2017-08-03 10:47:28,880 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 10:47:28,880 _log_validation: [2371] Validation set cost history: 409.6 [297.9]
2017-08-03 10:47:28,881 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 10.9 minutes. Best validation perplexity 297.95.
2017-08-03 10:47:44,138 _log_update: [58] (2.4 %) of epoch 3 -- lr = 5, duration = 27.7 ms
2017-08-03 10:48:36,936 _log_update: [258] (10.9 %) of epoch 3 -- lr = 5, duration = 26.2 ms
2017-08-03 10:49:29,855 _log_update: [458] (19.3 %) of epoch 3 -- lr = 5, duration = 27.5 ms
2017-08-03 10:50:22,612 _log_update: [658] (27.8 %) of epoch 3 -- lr = 5, duration = 26.9 ms
2017-08-03 10:51:15,429 _log_update: [858] (36.2 %) of epoch 3 -- lr = 5, duration = 26.0 ms
2017-08-03 10:52:08,338 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 5, duration = 25.9 ms
2017-08-03 10:53:01,540 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 5, duration = 27.5 ms
2017-08-03 10:53:54,060 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 5, duration = 25.8 ms
2017-08-03 10:54:46,754 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 5, duration = 27.2 ms
2017-08-03 10:55:39,544 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 5, duration = 25.7 ms
2017-08-03 10:56:32,453 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 5, duration = 24.8 ms
2017-08-03 10:57:25,612 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 5, duration = 27.1 ms
2017-08-03 10:57:57,525 _validate: [2365] First validation sample, perplexity 261.14.
2017-08-03 10:58:09,885 _validate: [2368] Center of validation, perplexity 240.67.
2017-08-03 10:58:22,243 _validate: [2371] Last validation sample, perplexity 242.48.
2017-08-03 10:58:22,261 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 10:58:22,261 _log_validation: [2371] Validation set cost history: 409.6 297.9 [242.5]
2017-08-03 10:58:22,262 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 10.9 minutes. Best validation perplexity 242.48.
2017-08-03 10:58:45,138 _log_update: [87] (3.7 %) of epoch 4 -- lr = 5, duration = 25.5 ms
2017-08-03 10:59:38,085 _log_update: [287] (12.1 %) of epoch 4 -- lr = 5, duration = 28.8 ms
2017-08-03 11:00:30,457 _log_update: [487] (20.5 %) of epoch 4 -- lr = 5, duration = 25.8 ms
2017-08-03 11:01:23,172 _log_update: [687] (29.0 %) of epoch 4 -- lr = 5, duration = 26.6 ms
2017-08-03 11:02:15,888 _log_update: [887] (37.4 %) of epoch 4 -- lr = 5, duration = 27.3 ms
2017-08-03 11:03:08,796 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 5, duration = 25.6 ms
2017-08-03 11:04:01,728 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 5, duration = 26.8 ms
2017-08-03 11:04:54,490 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 5, duration = 25.7 ms
2017-08-03 11:05:47,524 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 5, duration = 25.5 ms
2017-08-03 11:06:40,641 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 5, duration = 26.9 ms
2017-08-03 11:07:33,490 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 5, duration = 25.0 ms
2017-08-03 11:08:26,442 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 5, duration = 26.4 ms
2017-08-03 11:08:50,994 _validate: [2365] First validation sample, perplexity 212.48.
2017-08-03 11:09:03,302 _validate: [2368] Center of validation, perplexity 210.60.
2017-08-03 11:09:15,684 _validate: [2371] Last validation sample, perplexity 216.40.
2017-08-03 11:09:15,701 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 11:09:15,701 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 [212.5]
2017-08-03 11:09:15,703 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 10.9 minutes. Best validation perplexity 212.48.
2017-08-03 11:09:46,229 _log_update: [116] (4.9 %) of epoch 5 -- lr = 5, duration = 25.3 ms
2017-08-03 11:10:39,247 _log_update: [316] (13.3 %) of epoch 5 -- lr = 5, duration = 27.2 ms
2017-08-03 11:11:32,228 _log_update: [516] (21.8 %) of epoch 5 -- lr = 5, duration = 28.3 ms
2017-08-03 11:12:25,267 _log_update: [716] (30.2 %) of epoch 5 -- lr = 5, duration = 27.8 ms
2017-08-03 11:13:17,940 _log_update: [916] (38.6 %) of epoch 5 -- lr = 5, duration = 26.9 ms
2017-08-03 11:14:10,607 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 5, duration = 27.5 ms
2017-08-03 11:15:03,499 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 5, duration = 25.7 ms
2017-08-03 11:15:56,187 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 5, duration = 26.2 ms
2017-08-03 11:16:49,037 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 5, duration = 26.2 ms
2017-08-03 11:17:42,172 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 5, duration = 26.9 ms
2017-08-03 11:18:35,011 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 5, duration = 26.1 ms
2017-08-03 11:19:27,691 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 5, duration = 25.8 ms
2017-08-03 11:19:44,417 _validate: [2365] First validation sample, perplexity 199.09.
2017-08-03 11:19:56,749 _validate: [2368] Center of validation, perplexity 204.95.
2017-08-03 11:20:09,134 _validate: [2371] Last validation sample, perplexity 202.80.
2017-08-03 11:20:09,151 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 11:20:09,151 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 [199.1]
2017-08-03 11:20:09,152 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 10.9 minutes. Best validation perplexity 199.09.
2017-08-03 11:20:47,359 _log_update: [145] (6.1 %) of epoch 6 -- lr = 5, duration = 25.4 ms
2017-08-03 11:21:40,532 _log_update: [345] (14.6 %) of epoch 6 -- lr = 5, duration = 26.3 ms
2017-08-03 11:22:33,308 _log_update: [545] (23.0 %) of epoch 6 -- lr = 5, duration = 26.3 ms
2017-08-03 11:23:26,100 _log_update: [745] (31.4 %) of epoch 6 -- lr = 5, duration = 27.1 ms
2017-08-03 11:24:19,067 _log_update: [945] (39.9 %) of epoch 6 -- lr = 5, duration = 24.7 ms
2017-08-03 11:25:12,063 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 5, duration = 28.4 ms
2017-08-03 11:26:05,018 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 5, duration = 25.8 ms
2017-08-03 11:26:57,762 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 5, duration = 28.0 ms
2017-08-03 11:27:50,118 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 5, duration = 26.9 ms
2017-08-03 11:28:43,034 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 5, duration = 25.4 ms
2017-08-03 11:29:35,637 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 5, duration = 27.5 ms
2017-08-03 11:30:28,368 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 5, duration = 27.1 ms
2017-08-03 11:30:37,489 _validate: [2365] First validation sample, perplexity 213.91.
2017-08-03 11:30:49,802 _validate: [2368] Center of validation, perplexity 181.15.
2017-08-03 11:31:02,143 _validate: [2371] Last validation sample, perplexity 187.45.
2017-08-03 11:31:02,160 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 11:31:02,161 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 [187.5]
2017-08-03 11:31:02,161 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 10.9 minutes. Best validation perplexity 187.45.
2017-08-03 11:31:48,174 _log_update: [174] (7.3 %) of epoch 7 -- lr = 5, duration = 27.2 ms
2017-08-03 11:32:40,787 _log_update: [374] (15.8 %) of epoch 7 -- lr = 5, duration = 26.7 ms
2017-08-03 11:33:33,922 _log_update: [574] (24.2 %) of epoch 7 -- lr = 5, duration = 26.4 ms
2017-08-03 11:34:26,402 _log_update: [774] (32.6 %) of epoch 7 -- lr = 5, duration = 27.0 ms
2017-08-03 11:35:19,258 _log_update: [974] (41.1 %) of epoch 7 -- lr = 5, duration = 28.0 ms
2017-08-03 11:36:12,162 _log_update: [1174] (49.5 %) of epoch 7 -- lr = 5, duration = 25.6 ms
2017-08-03 11:37:05,023 _log_update: [1374] (58.0 %) of epoch 7 -- lr = 5, duration = 25.7 ms
2017-08-03 11:37:57,653 _log_update: [1574] (66.4 %) of epoch 7 -- lr = 5, duration = 27.8 ms
2017-08-03 11:38:50,586 _log_update: [1774] (74.8 %) of epoch 7 -- lr = 5, duration = 24.0 ms
2017-08-03 11:39:43,729 _log_update: [1974] (83.3 %) of epoch 7 -- lr = 5, duration = 27.5 ms
2017-08-03 11:40:36,669 _log_update: [2174] (91.7 %) of epoch 7 -- lr = 5, duration = 26.3 ms
2017-08-03 11:41:30,763 _validate: [2365] First validation sample, perplexity 173.17.
2017-08-03 11:41:43,072 _validate: [2368] Center of validation, perplexity 172.00.
2017-08-03 11:41:55,384 _validate: [2371] Last validation sample, perplexity 176.88.
2017-08-03 11:41:55,401 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 11:41:55,401 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 [173.9]
2017-08-03 11:41:55,402 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 10.9 minutes. Best validation perplexity 173.87.
2017-08-03 11:41:56,183 _log_update: [3] (0.1 %) of epoch 8 -- lr = 5, duration = 26.2 ms
2017-08-03 11:42:49,265 _log_update: [203] (8.6 %) of epoch 8 -- lr = 5, duration = 27.3 ms
2017-08-03 11:43:42,005 _log_update: [403] (17.0 %) of epoch 8 -- lr = 5, duration = 28.0 ms
2017-08-03 11:44:35,030 _log_update: [603] (25.4 %) of epoch 8 -- lr = 5, duration = 26.1 ms
2017-08-03 11:45:27,733 _log_update: [803] (33.9 %) of epoch 8 -- lr = 5, duration = 26.8 ms
2017-08-03 11:46:20,571 _log_update: [1003] (42.3 %) of epoch 8 -- lr = 5, duration = 29.0 ms
2017-08-03 11:47:13,192 _log_update: [1203] (50.7 %) of epoch 8 -- lr = 5, duration = 26.4 ms
2017-08-03 11:48:05,995 _log_update: [1403] (59.2 %) of epoch 8 -- lr = 5, duration = 26.3 ms
2017-08-03 11:48:59,194 _log_update: [1603] (67.6 %) of epoch 8 -- lr = 5, duration = 29.9 ms
2017-08-03 11:49:51,957 _log_update: [1803] (76.0 %) of epoch 8 -- lr = 5, duration = 26.2 ms
2017-08-03 11:50:44,920 _log_update: [2003] (84.5 %) of epoch 8 -- lr = 5, duration = 24.7 ms
2017-08-03 11:51:37,725 _log_update: [2203] (92.9 %) of epoch 8 -- lr = 5, duration = 25.4 ms
2017-08-03 11:52:24,471 _validate: [2365] First validation sample, perplexity 166.08.
2017-08-03 11:52:36,782 _validate: [2368] Center of validation, perplexity 166.51.
2017-08-03 11:52:49,094 _validate: [2371] Last validation sample, perplexity 169.76.
2017-08-03 11:52:49,111 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 11:52:49,111 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 [169.7]
2017-08-03 11:52:49,113 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 10.9 minutes. Best validation perplexity 169.71.
2017-08-03 11:52:57,557 _log_update: [32] (1.3 %) of epoch 9 -- lr = 5, duration = 25.9 ms
2017-08-03 11:53:50,457 _log_update: [232] (9.8 %) of epoch 9 -- lr = 5, duration = 28.5 ms
2017-08-03 11:54:43,435 _log_update: [432] (18.2 %) of epoch 9 -- lr = 5, duration = 25.2 ms
2017-08-03 11:55:36,201 _log_update: [632] (26.7 %) of epoch 9 -- lr = 5, duration = 27.0 ms
2017-08-03 11:56:28,896 _log_update: [832] (35.1 %) of epoch 9 -- lr = 5, duration = 27.9 ms
2017-08-03 11:57:21,609 _log_update: [1032] (43.5 %) of epoch 9 -- lr = 5, duration = 26.4 ms
2017-08-03 11:58:14,467 _log_update: [1232] (52.0 %) of epoch 9 -- lr = 5, duration = 28.5 ms
2017-08-03 11:59:07,175 _log_update: [1432] (60.4 %) of epoch 9 -- lr = 5, duration = 27.4 ms
2017-08-03 12:00:00,168 _log_update: [1632] (68.8 %) of epoch 9 -- lr = 5, duration = 27.5 ms
2017-08-03 12:00:53,104 _log_update: [1832] (77.3 %) of epoch 9 -- lr = 5, duration = 27.0 ms
2017-08-03 12:01:45,740 _log_update: [2032] (85.7 %) of epoch 9 -- lr = 5, duration = 26.5 ms
2017-08-03 12:02:38,598 _log_update: [2232] (94.1 %) of epoch 9 -- lr = 5, duration = 27.4 ms
2017-08-03 12:03:17,491 _validate: [2365] First validation sample, perplexity 176.73.
2017-08-03 12:03:29,781 _validate: [2368] Center of validation, perplexity 167.70.
2017-08-03 12:03:42,140 _validate: [2371] Last validation sample, perplexity 168.71.
2017-08-03 12:03:42,157 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 12:03:42,157 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 [167.7]
2017-08-03 12:03:42,158 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 10.9 minutes. Best validation perplexity 167.70.
2017-08-03 12:03:58,359 _log_update: [61] (2.6 %) of epoch 10 -- lr = 5, duration = 26.2 ms
2017-08-03 12:04:51,046 _log_update: [261] (11.0 %) of epoch 10 -- lr = 5, duration = 26.7 ms
2017-08-03 12:05:43,817 _log_update: [461] (19.4 %) of epoch 10 -- lr = 5, duration = 26.1 ms
2017-08-03 12:06:36,667 _log_update: [661] (27.9 %) of epoch 10 -- lr = 5, duration = 26.7 ms
2017-08-03 12:07:29,409 _log_update: [861] (36.3 %) of epoch 10 -- lr = 5, duration = 25.8 ms
2017-08-03 12:08:22,044 _log_update: [1061] (44.7 %) of epoch 10 -- lr = 5, duration = 26.9 ms
2017-08-03 12:09:15,004 _log_update: [1261] (53.2 %) of epoch 10 -- lr = 5, duration = 25.9 ms
2017-08-03 12:10:07,877 _log_update: [1461] (61.6 %) of epoch 10 -- lr = 5, duration = 26.7 ms
2017-08-03 12:11:00,710 _log_update: [1661] (70.1 %) of epoch 10 -- lr = 5, duration = 24.7 ms
2017-08-03 12:11:53,393 _log_update: [1861] (78.5 %) of epoch 10 -- lr = 5, duration = 26.4 ms
2017-08-03 12:12:45,964 _log_update: [2061] (86.9 %) of epoch 10 -- lr = 5, duration = 26.0 ms
2017-08-03 12:13:38,651 _log_update: [2261] (95.4 %) of epoch 10 -- lr = 5, duration = 25.9 ms
2017-08-03 12:14:10,078 _validate: [2365] First validation sample, perplexity 180.48.
2017-08-03 12:14:22,424 _validate: [2368] Center of validation, perplexity 175.06.
2017-08-03 12:14:34,753 _validate: [2371] Last validation sample, perplexity 165.07.
2017-08-03 12:14:34,753 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 [167.7] 175.1
2017-08-03 12:14:34,755 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 12:14:34,755 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 12:14:34,756 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 12:14:34,756 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 12:14:34,759 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 12:14:34,760 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 12:14:34,761 _reset_state: [2368] (99.87 %) of epoch 9
2017-08-03 12:14:34,762 _log_validation: [2368] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 [167.7]
2017-08-03 12:14:34,762 set_state: Restored iterator to line 42027 of 42068.
2017-08-03 12:14:34,763 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 12:14:34,763 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-08-03 12:14:34,764 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 12:14:34,765 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 12:14:34,773 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 12:14:34,773 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 9.
2017-08-03 12:14:34,775 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 10.9 minutes. Best validation perplexity 167.70.
2017-08-03 12:14:58,712 _log_update: [90] (3.8 %) of epoch 10 -- lr = 2, duration = 27.2 ms
2017-08-03 12:15:51,643 _log_update: [290] (12.2 %) of epoch 10 -- lr = 2, duration = 26.3 ms
2017-08-03 12:16:44,482 _log_update: [490] (20.7 %) of epoch 10 -- lr = 2, duration = 27.6 ms
2017-08-03 12:17:37,265 _log_update: [690] (29.1 %) of epoch 10 -- lr = 2, duration = 25.1 ms
2017-08-03 12:18:30,003 _log_update: [890] (37.5 %) of epoch 10 -- lr = 2, duration = 27.0 ms
2017-08-03 12:19:22,928 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 2, duration = 25.9 ms
2017-08-03 12:20:15,789 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 2, duration = 27.0 ms
2017-08-03 12:21:08,650 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 2, duration = 26.3 ms
2017-08-03 12:22:01,515 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 2, duration = 27.2 ms
2017-08-03 12:22:54,144 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 2, duration = 26.0 ms
2017-08-03 12:23:47,315 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 2, duration = 26.9 ms
2017-08-03 12:24:40,269 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 2, duration = 27.1 ms
2017-08-03 12:25:03,912 _validate: [2365] First validation sample, perplexity 164.81.
2017-08-03 12:25:16,200 _validate: [2368] Center of validation, perplexity 156.95.
2017-08-03 12:25:28,555 _validate: [2371] Last validation sample, perplexity 155.94.
2017-08-03 12:25:28,572 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 12:25:28,572 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 [158.8]
2017-08-03 12:25:28,573 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 10.9 minutes. Best validation perplexity 158.78.
2017-08-03 12:26:00,001 _log_update: [119] (5.0 %) of epoch 11 -- lr = 2, duration = 27.6 ms
2017-08-03 12:26:52,978 _log_update: [319] (13.5 %) of epoch 11 -- lr = 2, duration = 25.1 ms
2017-08-03 12:27:45,640 _log_update: [519] (21.9 %) of epoch 11 -- lr = 2, duration = 25.4 ms
2017-08-03 12:28:38,447 _log_update: [719] (30.3 %) of epoch 11 -- lr = 2, duration = 28.7 ms
2017-08-03 12:29:31,065 _log_update: [919] (38.8 %) of epoch 11 -- lr = 2, duration = 27.2 ms
2017-08-03 12:30:23,931 _log_update: [1119] (47.2 %) of epoch 11 -- lr = 2, duration = 25.9 ms
2017-08-03 12:31:16,713 _log_update: [1319] (55.6 %) of epoch 11 -- lr = 2, duration = 25.7 ms
2017-08-03 12:32:09,487 _log_update: [1519] (64.1 %) of epoch 11 -- lr = 2, duration = 28.3 ms
2017-08-03 12:33:02,514 _log_update: [1719] (72.5 %) of epoch 11 -- lr = 2, duration = 28.8 ms
2017-08-03 12:33:55,274 _log_update: [1919] (80.9 %) of epoch 11 -- lr = 2, duration = 27.0 ms
2017-08-03 12:34:48,190 _log_update: [2119] (89.4 %) of epoch 11 -- lr = 2, duration = 25.2 ms
2017-08-03 12:35:40,835 _log_update: [2319] (97.8 %) of epoch 11 -- lr = 2, duration = 24.6 ms
2017-08-03 12:35:56,832 _validate: [2365] First validation sample, perplexity 159.73.
2017-08-03 12:36:09,184 _validate: [2368] Center of validation, perplexity 162.23.
2017-08-03 12:36:21,552 _validate: [2371] Last validation sample, perplexity 157.37.
2017-08-03 12:36:21,569 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 12:36:21,569 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 [158.4]
2017-08-03 12:36:21,570 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 10.9 minutes. Best validation perplexity 158.42.
2017-08-03 12:37:00,495 _log_update: [148] (6.2 %) of epoch 12 -- lr = 2, duration = 24.9 ms
2017-08-03 12:37:53,356 _log_update: [348] (14.7 %) of epoch 12 -- lr = 2, duration = 25.6 ms
2017-08-03 12:38:46,232 _log_update: [548] (23.1 %) of epoch 12 -- lr = 2, duration = 26.0 ms
2017-08-03 12:39:39,039 _log_update: [748] (31.5 %) of epoch 12 -- lr = 2, duration = 27.3 ms
2017-08-03 12:40:31,878 _log_update: [948] (40.0 %) of epoch 12 -- lr = 2, duration = 25.9 ms
2017-08-03 12:41:24,851 _log_update: [1148] (48.4 %) of epoch 12 -- lr = 2, duration = 27.6 ms
2017-08-03 12:42:17,546 _log_update: [1348] (56.9 %) of epoch 12 -- lr = 2, duration = 25.1 ms
2017-08-03 12:43:10,387 _log_update: [1548] (65.3 %) of epoch 12 -- lr = 2, duration = 25.1 ms
2017-08-03 12:44:03,214 _log_update: [1748] (73.7 %) of epoch 12 -- lr = 2, duration = 26.6 ms
2017-08-03 12:44:55,795 _log_update: [1948] (82.2 %) of epoch 12 -- lr = 2, duration = 24.8 ms
2017-08-03 12:45:48,688 _log_update: [2148] (90.6 %) of epoch 12 -- lr = 2, duration = 28.1 ms
2017-08-03 12:46:41,338 _log_update: [2348] (99.0 %) of epoch 12 -- lr = 2, duration = 27.0 ms
2017-08-03 12:46:49,625 _validate: [2365] First validation sample, perplexity 159.39.
2017-08-03 12:47:01,894 _validate: [2368] Center of validation, perplexity 162.53.
2017-08-03 12:47:14,212 _validate: [2371] Last validation sample, perplexity 170.93.
2017-08-03 12:47:14,212 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 [158.4] 161.3
2017-08-03 12:47:14,214 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 12:47:14,214 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 12:47:14,215 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 12:47:14,215 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 12:47:14,218 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 12:47:14,219 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 12:47:14,220 _reset_state: [2368] (99.87 %) of epoch 11
2017-08-03 12:47:14,220 _log_validation: [2368] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 [158.4]
2017-08-03 12:47:14,220 set_state: Restored iterator to line 42025 of 42068.
2017-08-03 12:47:14,221 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 12:47:14,221 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-08-03 12:47:14,222 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 12:47:14,223 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 12:47:14,231 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 12:47:14,231 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 11.
2017-08-03 12:47:14,232 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 10.9 minutes. Best validation perplexity 158.42.
2017-08-03 12:48:01,003 _log_update: [177] (7.5 %) of epoch 12 -- lr = 1, duration = 26.5 ms
2017-08-03 12:48:53,832 _log_update: [377] (15.9 %) of epoch 12 -- lr = 1, duration = 26.2 ms
2017-08-03 12:49:46,650 _log_update: [577] (24.3 %) of epoch 12 -- lr = 1, duration = 23.4 ms
2017-08-03 12:50:39,418 _log_update: [777] (32.8 %) of epoch 12 -- lr = 1, duration = 25.0 ms
2017-08-03 12:51:31,997 _log_update: [977] (41.2 %) of epoch 12 -- lr = 1, duration = 25.5 ms
2017-08-03 12:52:24,952 _log_update: [1177] (49.6 %) of epoch 12 -- lr = 1, duration = 25.4 ms
2017-08-03 12:53:18,118 _log_update: [1377] (58.1 %) of epoch 12 -- lr = 1, duration = 25.1 ms
2017-08-03 12:54:11,224 _log_update: [1577] (66.5 %) of epoch 12 -- lr = 1, duration = 25.6 ms
2017-08-03 12:55:03,833 _log_update: [1777] (74.9 %) of epoch 12 -- lr = 1, duration = 24.6 ms
2017-08-03 12:55:56,746 _log_update: [1977] (83.4 %) of epoch 12 -- lr = 1, duration = 27.0 ms
2017-08-03 12:56:49,549 _log_update: [2177] (91.8 %) of epoch 12 -- lr = 1, duration = 29.9 ms
2017-08-03 12:57:43,150 _validate: [2365] First validation sample, perplexity 158.35.
2017-08-03 12:57:55,486 _validate: [2368] Center of validation, perplexity 157.08.
2017-08-03 12:58:07,781 _validate: [2371] Last validation sample, perplexity 156.65.
2017-08-03 12:58:07,798 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 12:58:07,798 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 158.4 [157.1]
2017-08-03 12:58:07,799 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 10.9 minutes. Best validation perplexity 157.08.
2017-08-03 12:58:09,393 _log_update: [6] (0.3 %) of epoch 13 -- lr = 1, duration = 26.3 ms
2017-08-03 12:59:02,291 _log_update: [206] (8.7 %) of epoch 13 -- lr = 1, duration = 26.6 ms
2017-08-03 12:59:55,050 _log_update: [406] (17.1 %) of epoch 13 -- lr = 1, duration = 28.0 ms
2017-08-03 13:00:47,750 _log_update: [606] (25.6 %) of epoch 13 -- lr = 1, duration = 26.3 ms
2017-08-03 13:01:41,088 _log_update: [806] (34.0 %) of epoch 13 -- lr = 1, duration = 27.5 ms
2017-08-03 13:02:34,535 _log_update: [1006] (42.4 %) of epoch 13 -- lr = 1, duration = 26.8 ms
2017-08-03 13:03:27,890 _log_update: [1206] (50.9 %) of epoch 13 -- lr = 1, duration = 27.0 ms
2017-08-03 13:04:20,500 _log_update: [1406] (59.3 %) of epoch 13 -- lr = 1, duration = 24.9 ms
2017-08-03 13:05:13,205 _log_update: [1606] (67.7 %) of epoch 13 -- lr = 1, duration = 26.7 ms
2017-08-03 13:06:06,034 _log_update: [1806] (76.2 %) of epoch 13 -- lr = 1, duration = 26.9 ms
2017-08-03 13:06:59,143 _log_update: [2006] (84.6 %) of epoch 13 -- lr = 1, duration = 24.9 ms
2017-08-03 13:07:52,064 _log_update: [2206] (93.0 %) of epoch 13 -- lr = 1, duration = 25.6 ms
2017-08-03 13:08:37,786 _validate: [2365] First validation sample, perplexity 162.99.
2017-08-03 13:08:50,088 _validate: [2368] Center of validation, perplexity 157.54.
2017-08-03 13:09:02,463 _validate: [2371] Last validation sample, perplexity 157.48.
2017-08-03 13:09:02,463 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 158.4 [157.1] 157.8
2017-08-03 13:09:02,464 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 13:09:02,465 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 13:09:02,465 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 13:09:02,466 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 13:09:02,469 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 13:09:02,469 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 13:09:02,471 _reset_state: [2368] (99.87 %) of epoch 12
2017-08-03 13:09:02,471 _log_validation: [2368] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 158.4 [157.1]
2017-08-03 13:09:02,471 set_state: Restored iterator to line 42022 of 42068.
2017-08-03 13:09:02,472 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 13:09:02,472 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-08-03 13:09:02,473 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 13:09:02,474 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 13:09:02,482 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 13:09:02,483 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 12.
2017-08-03 13:09:02,484 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 10.9 minutes. Best validation perplexity 157.08.
2017-08-03 13:09:11,765 _log_update: [35] (1.5 %) of epoch 13 -- lr = 0.6, duration = 27.1 ms
2017-08-03 13:10:04,676 _log_update: [235] (9.9 %) of epoch 13 -- lr = 0.6, duration = 25.6 ms
2017-08-03 13:10:57,298 _log_update: [435] (18.3 %) of epoch 13 -- lr = 0.6, duration = 26.2 ms
2017-08-03 13:11:50,154 _log_update: [635] (26.8 %) of epoch 13 -- lr = 0.6, duration = 24.7 ms
2017-08-03 13:12:42,797 _log_update: [835] (35.2 %) of epoch 13 -- lr = 0.6, duration = 27.1 ms
2017-08-03 13:13:35,517 _log_update: [1035] (43.7 %) of epoch 13 -- lr = 0.6, duration = 26.2 ms
2017-08-03 13:14:28,280 _log_update: [1235] (52.1 %) of epoch 13 -- lr = 0.6, duration = 25.6 ms
2017-08-03 13:15:21,332 _log_update: [1435] (60.5 %) of epoch 13 -- lr = 0.6, duration = 27.4 ms
2017-08-03 13:16:14,180 _log_update: [1635] (69.0 %) of epoch 13 -- lr = 0.6, duration = 28.5 ms
2017-08-03 13:17:07,069 _log_update: [1835] (77.4 %) of epoch 13 -- lr = 0.6, duration = 25.4 ms
2017-08-03 13:18:00,023 _log_update: [2035] (85.8 %) of epoch 13 -- lr = 0.6, duration = 27.3 ms
2017-08-03 13:18:52,867 _log_update: [2235] (94.3 %) of epoch 13 -- lr = 0.6, duration = 27.0 ms
2017-08-03 13:19:30,978 _validate: [2365] First validation sample, perplexity 160.37.
2017-08-03 13:19:43,290 _validate: [2368] Center of validation, perplexity 158.71.
2017-08-03 13:19:55,641 _validate: [2371] Last validation sample, perplexity 157.96.
2017-08-03 13:19:55,641 _log_validation: [2371] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 158.4 [157.1] 158.5
2017-08-03 13:19:55,642 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 13:19:55,643 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 13:19:55,643 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 13:19:55,644 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 13:19:55,647 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 13:19:55,647 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 13:19:55,648 _reset_state: [2368] (99.87 %) of epoch 12
2017-08-03 13:19:55,649 _log_validation: [2368] Validation set cost history: 409.6 297.9 242.5 212.5 199.1 187.5 173.9 169.7 167.7 158.8 158.4 [157.1]
2017-08-03 13:19:55,649 set_state: Restored iterator to line 42022 of 42068.
2017-08-03 13:19:55,649 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 13:19:55,650 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2017-08-03 13:19:55,651 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 13:19:55,652 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 13:19:55,659 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 13:19:55,660 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 12.
Finished training epoch 12 in 0 hours 10.9 minutes. Best validation perplexity 157.08.
Training finished in 2 hours 54.2 minutes.
2017-08-03 13:19:55,663 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 13:19:55,663 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 13:19:55,664 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 13:19:55,664 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 13:19:55,668 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 13:19:55,669 set_state: layers/output_layer/input/b <- array(10001,)
Best validation set perplexity: 157.080491432
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.8623783259287485
Perplexity: 129.331428910605
