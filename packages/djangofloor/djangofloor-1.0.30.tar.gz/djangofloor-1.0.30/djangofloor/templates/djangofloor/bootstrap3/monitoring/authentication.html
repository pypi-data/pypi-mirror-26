{% load bootstrap3 i18n l10n djangofloor %}
<div class="col-md-12 col-sm-12 col-xs-12" id="celery_stats">
  <div class="panel panel-info">
    <div class="panel-heading">
      <h3 class="panel-title">{% trans 'Authentication' %}</h3>
    </div>
    <div class="panel-body">
      {% with ok='<span class="label label-success"><span class="glyphicon glyphicon-ok"></span></span>' ko='<span class="label label-danger"><span class="glyphicon glyphicon-remove"></span></span>' %}
      <ul class="list-unstyled">

        <li><strong>{% trans 'Local passwords: ' %}</strong>
          {% if local_users %}{{ ok }}{% else %}{{ ko }}{% endif %}
        </li>
        {% if local_users %}
        <li><strong>{% trans 'Allow visitors to create an account: ' %}</strong>{% if allow_user_creation %}{{ ok }}{% else %}{{ ko }}{% endif %}
        </li>
        {% endif %}

        <li><strong>{% trans 'Social external authentications: ' %}</strong> {% if allauth %}{{ allauth|join:', ' }}
          {% else %}{{ ko }}{% endif %}
        </li>

        <li><strong>{% trans 'PAM authentication: ' %}</strong>
          {% if pam %}{{ ok }}{% else %}{{ ko }}{% endif %}
        </li>

        <li><strong>{% trans 'Basic HTTP authentication: ' %}</strong>
          {% if basic_auth %}{{ ok }}{% else %}{{ ko }}{% endif %}
        </li>

        <li><strong>{% trans 'HTTP authentication by header: ' %}</strong>
          {% if remote_user %}<span class="label label-success">{{ remote_user|upper }}</span>{% else %}{{ ko }}{% endif %}
        </li>
        {% if remote_user %}
        <li><strong>{% trans 'Automatically create new users: ' %}</strong>{% if allow_user_creation %}{{ ok }}{% else %}{{ ko }}{% endif %}
        </li>
        {% endif %}
        {% if remote_user and remote_user_groups %}
        <li><strong>{% trans 'Groups of new users: '%}</strong>{{ remote_user_groups|join:', ' }}</li>
        {% endif %}

        <li><strong>{% trans 'LDAP authentication: ' %}</strong>
          {% if ldap %}{{ ok }}{% else %}{{ ko }}{% endif %}
        </li>

        <li><strong>{% trans 'Maximum time between successive authentications: ' %}</strong>{{ session_age }}</li>

      </ul>
      {% endwith %}
    </div>
  </div>
</div>

