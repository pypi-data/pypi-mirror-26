$(document).ready(function(){$.ZTFY.sendit={form:{addDocument:function(a){var f=$(a).parents("DIV.widgets-suffix");var j=f.prev();var g=$('INPUT[name="documents.widgets.data"], INPUT[name="documents.widgets.data:list"]',j);if(!g.val()){return}var h=j.clone();var i=$("DIV.documents_list").removeClass("hidden");$("DIV.label",j).hide();var k=$('INPUT[name="documents.widgets.title"], INPUT[name="documents.widgets.title:list"]',j);var b=$('<input type="hidden" name="documents.widgets.title" />').val(k.val());$("<span>").text(b.val()).insertAfter(k);k.replaceWith(b);g.attr("disabled",true);$("<i>").attr("class","icon icon-trash").attr("title","Enlever ce document").click($.ZTFY.sendit.form.removeDocument).insertAfter(g);j.detach().appendTo(i);$("INPUT, INPUT",h).val(null);h.insertBefore(f);var c=$(a).parents("DIV.actions");var e=c.data("sendit-documents-count");var d=$("DIV.widgets",i).length;if((d!=0)&&(d>=e-1)){$(a).attr("disabled",true)}},removeDocument:function(a){$(this).parents("DIV.widgets").remove();$("INPUT:button",$("DIV.widgets-suffix DIV.actions")).attr("disabled",false)},removeOldDocument:function(a){$(a).parents("DIV.item").remove()},checkDocumentsUpload:function(c,b){var d=$(b).data("sendit-documents-group");var a=$('DIV[id="'+d+'"]',c);$("INPUT:text, INPUT:hidden, INPUT:radio, INPUT:file, TEXTAREA",a).each(function(f,g){var e=$(g).attr("name");if(e&&!e.endsWith(":list")){$(g).attr("name",e+":list")}});$("INPUT:file",a).attr("disabled",false)},checkDocumentsInputs:function(d,b){var f=$(b).data("sendit-documents-id");var c=$(b).data("sendit-documents-name");var a=!$('INPUT[id="'+f+'"]').hasClass("required");var e=-1;$('INPUT[id^="'+f+'"]',$("DIV.document")).each(function(g,h){$(h).attr("id",f+"-"+g).attr("name",c+"."+g);if($(h).val()){a=true}e=g});$('INPUT[name="'+c+'.count"]',d).val(e+1);if(a){return true}else{return" - vous devez fournir au moins un document à télécharger !!"}},deletePacketCallback:function(a,b){if(b=="success"){if(typeof(a)=="string"){a=$.parseJSON(a)}var c=a.output;switch(c){case"OK":var d=$('DIV[id="delete_'+a.packet_oid+'"]');d.closest("TR").remove()}$.ZTFY.dialog.close()}}},profile:{openDialog:function(b){var a=$('INPUT[name="principal_id"]',"FIELDSET.profile-search").val();if(a){$.ZTFY.dialog.open("@@profile_edit.html?uid="+a)}}}};$("FIELDSET.profile-search").on("click","A.bit-box",$.ZTFY.sendit.profile.openDialog)});