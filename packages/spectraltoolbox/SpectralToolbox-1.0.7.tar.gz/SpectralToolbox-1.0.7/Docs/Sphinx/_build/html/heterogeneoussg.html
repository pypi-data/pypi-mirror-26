<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Heterogeneous Sparse Grids &mdash; SpectralToolbox 0.2.3 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="SpectralToolbox 0.2.3 documentation" href="index.html" />
    <link rel="up" title="Tutorial" href="tutorial.html" />
    <link rel="next" title="Summary" href="summary.html" />
    <link rel="prev" title="Sparse Grids" href="sparsegrids.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="summary.html" title="Summary"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sparsegrids.html" title="Sparse Grids"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SpectralToolbox 0.2.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="tutorial.html" accesskey="U">Tutorial</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Heterogeneous Sparse Grids</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="sparsegrids.html"
                        title="previous chapter">Sparse Grids</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="summary.html"
                        title="next chapter">Summary</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/heterogeneoussg.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="heterogeneous-sparse-grids">
<h1>Heterogeneous Sparse Grids<a class="headerlink" href="#heterogeneous-sparse-grids" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>This module is used to construct Heterogeneous Sparse Grids. These are integration rules based on Smolyak&#8217;s Sparse Grids <a class="footnote-reference" href="#id2" id="id1">[6]</a> built up in order to provide flexibility for both:</dt>
<dd><ol class="first last arabic simple">
<li>the types of polynomials to be used per direction</li>
<li>the accuracy to be used per direction</li>
</ol>
</dd>
</dl>
<p>The types of polynomials available are all the ones included in the module <code class="xref py py-mod docutils literal"><span class="pre">Spectral1D</span></code>. The rules don&#8217;t need to be symmetric and the accuracy per each direction can vary.</p>
<p>For rules with Heterogeneous accuracy, two sparse grids will be construced: one partial sparse grid and one full sparse grid (up to the maximum accuracy). The values computed for the partial sparse grid can then be used to interpolate on the points of the full sparse grid. This latter rule can then be used to compute the integral.</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[6]</a></td><td><ol class="first last upperalpha simple" start="19">
<li><ol class="first upperalpha">
<li>Smolyak, &#8220;Quadrature and interpolation formulas for tensor products of certain classes of functions&#8221;. Soviet Math. Dokl., 4:240–243, 1963</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s consider the following space <span class="math">\(\Omega = [-\infty,\infty]\times[0,1]\)</span> with the associated measures <span class="math">\(\mu_1(x)=\frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span> and  <span class="math">\(\mu_2(x)=1\)</span> for each dimension. The product measure is given by <span class="math">\(\mu(\bar{x})=\prod_{i=1}^n \mu_i(x_i)\)</span>. We will consider the function</p>
<div class="math">
\[f(\bar{x}) = x_1^{p_1} \cdot x_2^{p_2}\]</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f_mult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="n">xp</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="n">yp</span>
</pre></div>
</div>
<p>with exact value of the integral given by</p>
<div class="math">
\[\int_\Omega f(\bar{x}) \mu(\bar{x}) = \frac{2^{-1+p_2} \left( 1+(-1)^{p_2} \right) \Gamma\left( \frac{1+p_2}{2} \right)}{(1+p_1)\sqrt{\pi}}\]</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">I_mult</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="mf">2.</span><span class="o">**</span><span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="n">q</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
<p>Let <span class="math">\(p_1=2\)</span> and <span class="math">\(p_2=4\)</span>. We can obtain a sparse grid composed using Hermite basis (<code class="xref py py-const docutils literal"><span class="pre">Spectral1D.HERMITEP_PROB</span></code>) and Legendre basis (<code class="xref py py-const docutils literal"><span class="pre">Spectral1D.JACOBI</span></code>) with orders 2 and 4 respectively.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">SpectralToolbox</span> <span class="k">import</span> <span class="n">HeterogeneousSparseGrids</span> <span class="k">as</span> <span class="n">HSG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pH</span> <span class="o">=</span> <span class="n">Spectral1D</span><span class="o">.</span><span class="n">Poly1D</span><span class="p">(</span><span class="n">Spectral1D</span><span class="o">.</span><span class="n">HERMITEP_PROB</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pL</span> <span class="o">=</span> <span class="n">Spectral1D</span><span class="o">.</span><span class="n">Poly1D</span><span class="p">(</span><span class="n">Spectral1D</span><span class="o">.</span><span class="n">JACOBI</span><span class="p">,[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polys</span> <span class="o">=</span> <span class="p">[</span><span class="n">pH</span><span class="p">,</span><span class="n">pL</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span> <span class="o">=</span> <span class="n">HSG</span><span class="o">.</span><span class="n">HSparseGrid</span><span class="p">(</span><span class="n">polys</span><span class="p">,</span><span class="n">Ns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">XF</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">X</span><span class="p">)</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">sparseGrid</span><span class="p">()</span>
<span class="go">[SG] Sparse Grid Generation [============================================] 100%</span>
<span class="go">[SG] Sparse Grid Generation: 0.01s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">XF</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">XF</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XF</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">XF</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;or&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting partial and full sparse grids are shown in the following figure.</p>
<div class="figure" id="id3">
<span id="gridexample"></span><img alt="_images/HeterSparseGrids-GridExample.png" src="_images/HeterSparseGrids-GridExample.png" />
<p class="caption"><span class="caption-text">Partial (red) and full (blue) sparse grid. The full sparse grid is overlapping over the partial sparse grid.</span></p>
</div>
<p>The values on the partial grid can be computed and then the interpolation is taken over the full sparse grid.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fX</span> <span class="o">=</span> <span class="n">f_mult</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">Q</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fXF</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">sparseGridInterp</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">fX</span><span class="p">,</span><span class="n">XF</span><span class="p">)</span>
<span class="go">[SG] Sparse Grid Interpolation [=========================================] 100%</span>
<span class="go">[SG] Sparse Grid Interpolation: 0.00s</span>
</pre></div>
</div>
<p>Finally the error of the quadrature rule is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">IErr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fXF</span><span class="p">,</span><span class="n">W</span><span class="p">)</span><span class="o">-</span><span class="n">I_mult</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">P</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IErr</span>
<span class="go">3.33066907388e-16</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="summary.html" title="Summary"
             >next</a> |</li>
        <li class="right" >
          <a href="sparsegrids.html" title="Sparse Grids"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SpectralToolbox 0.2.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="tutorial.html" >Tutorial</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012-2016, Daniele Bigoni.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>